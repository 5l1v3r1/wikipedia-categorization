Hat puzzles are logic problems that date back to as early as 1961.   Such hat puzzles, frequently contextualized as prisoners and hats puzzles, are induction puzzles (a kind of logic puzzle) that involve reasoning about the actions of other people, drawing in aspects of Game theory sometimes called the hierarchy of beliefs. There are many variations, but the central theme remains the same. A number of players are each wearing a hat, which may be of various specified colours.  Players can see the colours of at least some other players' hats, but not that of their own.  With highly restricted communication or none, some of the players must guess the colour of their hat.  The problem is to find a strategy for the players to determine the colours of their hats based on the hats they see and what the other players do.  In some versions, they compete to be the first to guess correctly; in others, they can work out a strategy beforehand to cooperate and maximize the probability of correct guesses.  One variation received some new publicity as a result of Todd Ebert's 1998 Ph.D. thesis at the University of California, Santa Barbara.  It is a strategy question about a cooperative game, which has connections to algebraic coding theory.  Three players are told that each of them will receive either a red hat or a blue hat.  They are to raise their hands if they see a red hat on another player as they stand in a circle facing each other.  The first to guess the colour of his or her hat correctly wins. All three players raise their hands. After the players have seen each other for a few minutes without guessing, one player announces "Red", and wins.  How did the winner do it, and what is the color of everyone's hats? First, if two people had blue hats, not everyone's hand would have been raised. Next, if player 1 had seen a blue hat on player 2 & a red hat on player 3, then player 1 would have known immediately that his own hat must be red. Thus any player who sees a blue hat can guess at once. Finally, the winner realizes that since no one guesses at once, there must be no blue hats, so every hat must be red.  In the case where every player has to make a guess, but they are free to choose when to guess, there is a cooperative strategy that allows every player to guess correctly unless all the hats are the same colour.  Each player should act as follows: Suppose that in total there are B black hats and W white hats.  There are three cases. If B = W then those players wearing black hats see B−1 black hats and B white hats, so wait B−1 seconds then correctly guess that they are wearing a black hat.  Similarly, those players wearing a white hat will wait W−1 seconds before guessing correctly that they are wearing a white hat.  So all players make a correct guess at the same time. If B < W then those wearing a black hat will see B−1 black hats and W white hats, whilst those wearing a white hat will see B black hats and W−1 white hats.  Since B−1 < B ≤ W−1, those players wearing a black hat will be the first to speak, guessing correctly that their hat is black.  The other players then guess correctly that their hat is white. The case where W < B is similar. According to the story, four prisoners are arrested for a crime, but the jail is full and the jailer has nowhere to put them. He eventually comes up with the solution of giving them a puzzle so if they succeed they can go free but if they fail they are executed.   The jailer seats three of the men into a line. B faces the wall, C faces B, and D faces C and B. The fourth man, A, is put behind a screen (or in a separate room). The jailer gives all four men party hats. He explains that there are two black hats and two white hats, that each prisoner is wearing one of the hats, and that each of the prisoners see only the hats in front of him but neither on himself nor behind him. The fourth man behind the screen can't see or be seen by any other prisoner. No communication among the prisoners is allowed. If any prisoner can figure out what color hat he has on his own head with 100% certainty (without guessing) and tell the jailer, all four prisoners go free. If any prisoner suggests an incorrect answer, all four prisoners are executed. The puzzle is to find how the prisoners can escape. The prisoners know that there are only two hats of each color. So if D observes that B and C have hats of the same color, D would deduce that his own hat is the opposite color. However, if B and C have hats of different colors, then D can say nothing. The key is that prisoner C, after allowing an appropriate interval, and knowing what D would do, can deduce that if D says nothing the hats on B and C must be different; able to see B's hat, he can deduce his own hat color. In common with many puzzles of this type, the solution relies upon the assumption that all participants are totally rational and intelligent enough to make the appropriate deductions. After solving this puzzle, some insight into the nature of communication can be gained by pondering whether the meaningful silence of prisoner D violates the "No communication" rule (given that communication is usually defined as the "transfer of information"). In a variant of this puzzle, the prisoners know that there are 3 hats of one color and only 1 hat of another (e.g. 3 black and 1 white), and the 3 prisoners can see each other i.e. D sees B & C, B sees D & C, and C sees D & B. (A again cannot be seen and is only there to wear the last hat.) There are two cases: in the trivial case, one of the three prisoners wears the single off-color hat. Each of the other two prisoners can see that one prisoner is wearing the off-color hat. In the non-trivial case, the three prisoners wear hats of the same color, while A wears the off-color hat. After a while, all three prisoners should be able to deduce that, because neither of the others was able to state the color of his own hat, A must wear the off-color hat. In another variant, only three prisoners and five hats (supposedly two black and three white) are involved.  The three prisoners are ordered to stand in a straight line facing the front, with A in front and C at the back. They are told that there will be two black hats and three white hats. One hat is then put on each prisoner's head; each prisoner can only see the hats of the people in front of him and not on his own. The first prisoner that is able to announce the color of his hat correctly will be released. No communication between the prisoners is allowed. Assume that A wears a black hat:  So if A wears a black hat there will be a fairly quick response from B or C. Assume that A wears a white hat:  In this case A, B and C would remain silent for some time, until A finally deduces that he must have a white hat because C and B have remained silent for some time. As mentioned, there are three white hats and two black hats in total, and the three prisoners know this. In this riddle, you can assume that all three prisoners are very clever and very smart. If C could not guess the color of his own hat that is because he saw either two white hats or one of each color. If he saw two black hats, he could have deduced that he was wearing a white hat. In this variant there are 3 prisoners and 3 hats. Each prisoner is assigned a random hat, either red or blue. In all, there are three red hats and two blue. Each person can see the hats of two others, but not their own. On a cue, they each have to guess their own hat color or pass. They win release if at least one person guessed correctly and none guessed incorrectly (passing is neither correct nor incorrect). This puzzle doesn't have a 100% winning strategy, so the question is: What is the best strategy? Which strategy has the highest probability of winning? If you think of colors of hats as bits, this problem has some important applications in coding theory. The solution and the discussion of this puzzle can be found here (also a solution to the analogous 7-hat puzzle) and other 3 variants are available on this Logic Puzzles page (they are called Masters of Logic I-IV). In this variant there are 10 prisoners and 10 hats.  Each prisoner is assigned a random hat, either red or blue, but the number of each color hat is not known to the prisoners.  The prisoners will be lined up single file where each can see the hats in front of him but not behind.  Starting with the prisoner in the back of the line and moving forward, they must each, in turn, say only one word which must be "red" or "blue".  If the word matches their hat color they are released, if not, they are killed on the spot.  A friendly guard warns them of this test one hour beforehand and tells them that they can formulate a plan where by following the stated rules, 9 of the 10 prisoners will definitely survive, and 1 has a 50/50 chance of survival.  What is the plan to achieve the goal? The prisoners agree that if the first prisoner sees an odd number of red hats, he will say "red". This way, the nine other prisoners will know their own hat color after the prisoner behind them responds. As before, there are 10 prisoners and 10 hats.  Each prisoner is assigned a random hat, either red or blue, but the number of each color hat is not known to the prisoners.  The prisoners are distributed in the room such that they can see the hats of the others but not their own.  Now, they must each, simultaneously, say only one word which must be "red" or "blue".  If the word matches their hat color they are released, and if enough prisoners resume their liberty they can rescue the others. A friendly guard warns them of this test one hour beforehand.  If they can formulate a plan following the stated rules, 5 of the 10 prisoners will definitely be released and be able to rescue the others.  What is the plan to achieve the goal? The prisoners pair off. In a pair (A,B) of the prisoners A says the color he can see on the head of B, who says the opposite color he sees on the head of A. Then, if both wear hats with the same color, A is released (and B is not), if the colors are different, B is released (and A is not). In total, 5 prisoners answer correctly and 5 do not.  This assumes the pair can communicate who is A and who is B, which may not be allowed. Alternatively, the prisoners build two groups of 5. One group assumes that the number of red hats is even, the other assumes that there is an odd number of red hats. Similar to the variant with hearing, they can deduce their hat color out of this assumption. Exactly one group will be right, so 5 prisoners answer correctly and 5 do not. Note that the prisoners cannot find a strategy guaranteeing the release of more than 5 prisoners. Indeed, for a single prisoner, there are as many distributions of hat colors where he says the correct answer than there are where he does not. Hence, there are as many distributions of hat colors where 6 or more prisoners say the correct answer than there are where 4 or fewer do so. In this variant, a countably infinite number of prisoners, each with an unknown and randomly assigned red or blue hat line up single file line.  Each prisoner faces away from the beginning of the line, and each prisoner can see all the hats in front of him, and none of the hats behind.  Starting from the beginning of the line, each prisoner must correctly identify the color of his hat or he is killed on the spot.  As before, the prisoners have a chance to meet beforehand, but unlike before, once in line, no prisoner can hear what the other prisoners say.  The question is, is there a way to ensure that only finitely many prisoners are killed? If one accepts the axiom of choice, and assumes the prisoners each have the (unrealistic) ability to memorize an uncountably infinite amount of information and perform computations with uncountably infinite computational complexity, the answer is yes. In fact, even if we allow an uncountable number of different colors for the hats and an uncountable number of prisoners, the axiom of choice provides a solution that guarantees that only finitely many prisoners must die provided that each prisoner can see the hats of every other prisoner (not just those ahead of them in a line), or at least that each prisoner can see all but finitely many of the other hats. The solution for the two color case is as follows, and the solution for the uncountably infinite color case is essentially the same: The prisoners standing in line form a sequence of 0s and 1s, where 0 is taken to represent blue, and 1 is taken to represent red.  Before they are put into the line, the prisoners define the following equivalence relation over all possible sequences that they might be put into:  Two sequences are equivalent if they are identical after a finite number of entries.  From this equivalence relation, the prisoners get a collection of equivalence classes.  Assuming the axiom of choice, there exists a set of representative sequences—one from each equivalence class. (Almost every specific value is impossible to compute, but the axiom of choice implies that some set of values exists, so we assume that the prisoners have access to an oracle.) When they are put into their line, each prisoner can see all but a finite number of hats, and can therefore see which equivalence class the actual sequence of hats belongs to. (This assumes that each prisoner can perform an uncountably infinite number of comparisons to find a match, with each class comparison requiring a countably infinite number of individual hat-comparisons).  They then proceed guessing their hat color as if they were in the representative sequence from the appropriate equivalence class.  Because the actual sequence and the representative sequence are in the same equivalence class, their entries are the same after some finite number N of prisoners.  All prisoners after these first N prisoners are saved. Because the prisoners have no information about the color of their own hat and would make the same guess whichever color it has, each prisoner has a 50% chance of being killed. It may seem paradoxical that an infinite number of prisoners each have an even chance of being killed and yet it is certain that only a finite number are killed. However, there is no contradiction here, because this finite number can be arbitrarily large, and no probability can be assigned to any particular number being killed. This is easiest to see for the case of zero prisoners being killed. This happens if and only if the actual sequence is one of the selected representative sequences. If the sequences of 0s and 1s are viewed as binary representations of a real number between 0 and 1, the representative sequences form a non-measurable set. (This set is similar to a Vitali set, the only difference being that equivalence classes are formed with respect to numbers with finite binary representations rather than all rational numbers.) Hence no probability can be assigned to the event of zero prisoners being killed. The argument is similar for other finite numbers of prisoners being killed, corresponding to a finite number of variations of each representative. This variant is the same as the last one except that prisoners can hear the colors called out by other prisoners.  The question is, what is the optimal strategy for the prisoners such that the fewest of them die in the worst case? It turns out that, if one allows the prisoners to hear the colors called out by the other prisoners, it is possible to guarantee the life of every prisoner except the first, who dies with a 50% probability. To do this, we define the same equivalence relation as above and again select a representative sequence from each equivalence class.  Now, we label every sequence in each class with either a 0 or a 1.  First, we label the representative sequence with a 0.  Then, we label any sequence which differs from the representative sequence in an even number of places with a 0, and any sequence which differs from the representative sequence in an odd number of places with a 1.  In this manner, we have labeled every possible infinite sequence with a 0 or a 1 with the important property that any two sequences which differ by only one digit have opposite labels. Now, when the warden asks the first person to say a color, or in our new interpretation, a 0 or a 1, he simply calls out the label of the sequence he sees.  Given this information, everyone after him can determine exactly what his own hat color is.  The second person sees all but the first digit of the sequence that the first person sees. Thus, as far as he knows, there are two possible sequences the first person could have been labeling: one starting with a 0, and one starting with a 1.  Because of our labeling scheme, these two sequences would receive opposite labels, so based on what the first person says, the second person can determine which of the two possible strings the first person saw, and thus he can determine his own hat color.  Similarly, every later person in the line knows every digit of the sequence except the one corresponding to his own hat color.  He knows those before him because they were called out, and those after him because he can see them.  With this information, he can use the label called out by the first person to determine his own hat color.  Thus, everyone except the first person always guesses correctly. Ebert's version of the problem states that all players who guess must guess at the same predetermined time, but that not all players are required to guess.  Now not all players can guess correctly, so the players win if at least one player guesses and all of those who guess do so correctly.  How can the players maximise their chance of winning? One strategy for solving this version of the hat problem employs Hamming codes, which are commonly used to detect and correct errors in data transmission. The probability for winning will be much higher than 50%, depending on the number of players in the puzzle configuration: for example, a winning probability of 87.5% for 7 players. Similar strategies can be applied to team sizes of N = 2k−1 and achieve a win rate (2k-1)/2k.  Thus the Hamming code strategy yields greater win rates for larger values of N. In this version of the problem, any individual guess has a 50% chance of being right. However, the Hamming code approach works by concentrating wrong guesses together onto certain distributions of hats.  For some cases, all the players will guess incorrectly; whereas for the other cases, only one player will guess, but correctly.  While half of all guesses are still incorrect, this results in the players winning more than 50% of the time. A simple example of this type of solution with three players is instructive.  With three players, there are eight possibilities; in two of them all players have the same colour hat, and in the other six, two players have one colour and the other player has the other colour. The players can guarantee that they win in the latter cases (75% of the time) with the following strategy: In the two cases when all three players have the same hat colour, they will all guess incorrectly.  But in the other six cases, only one player will guess, and correctly, that his hat is the opposite of his fellow players'.  