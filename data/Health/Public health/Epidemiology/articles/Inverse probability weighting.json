{"parse":{"title":"Inverse probability weighting","pageid":33350282,"revid":860050251,"text":{"*":"<div class=\"mw-parser-output\"><p><b>Inverse probability weighting</b> is a statistical technique for calculating statistics standardized to a population different from that in which the data was collected. Study designs with a disparate sampling population and population of target inference (target population) are common in application.<sup id=\"cite_ref-refname2_1-0\" class=\"reference\"><a href=\"#cite_note-refname2-1\">&#91;1&#93;</a></sup> There may be prohibitive factors barring researchers from directly sampling from the target population such as cost, time, or ethical concerns.<sup id=\"cite_ref-refname3_2-0\" class=\"reference\"><a href=\"#cite_note-refname3-2\">&#91;2&#93;</a></sup> A solution to this problem is to use an alternate design strategy, e.g. stratified sampling. Weighting, when correctly applied, can potentially improve the efficiency and reduce the bias of unweighted estimators.\n</p><p>One very early weighted estimator is the <a href=\"/wiki/Horvitz%E2%80%93Thompson_estimator\" title=\"Horvitz\u2013Thompson estimator\">Horvitz\u2013Thompson estimator</a> of the mean.<sup id=\"cite_ref-3\" class=\"reference\"><a href=\"#cite_note-3\">&#91;3&#93;</a></sup> When the <a href=\"/wiki/Sampling_probability\" title=\"Sampling probability\">sampling probability</a> is known, from which the sampling population is drawn from the target population, then the inverse of this probability is used to weight the observations. This approach has been generalized to many aspects of statistics under various frameworks. In particular, there are <a href=\"/wiki/Likelihood_function\" title=\"Likelihood function\">weighted likelihoods</a>, <a href=\"/wiki/Generalized_estimating_equations\" class=\"mw-redirect\" title=\"Generalized estimating equations\">weighted estimating equations</a>, and <a href=\"/wiki/Probability_density_function\" title=\"Probability density function\">weighted probability densities</a> from which a majority of statistics are derived. These applications codified the theory of other statistics and estimators such as <a href=\"/wiki/Marginal_structural_models\" class=\"mw-redirect\" title=\"Marginal structural models\">marginal structural models</a>, the <a href=\"/wiki/Standardized_mortality_ratio\" title=\"Standardized mortality ratio\">standardized mortality ratio</a>, and the <a href=\"/wiki/EM_algorithm\" class=\"mw-redirect\" title=\"EM algorithm\">EM algorithm</a> for coarsened or aggregate data.\n</p><p>Inverse probability weighting is also used to account for missing data when subjects with missing data cannot be included in the primary analysis.<sup id=\"cite_ref-refname1_4-0\" class=\"reference\"><a href=\"#cite_note-refname1-4\">&#91;4&#93;</a></sup>\nWith an estimate of the sampling probability, or the probability that the factor would be measured in another measurement, inverse probability weighting can be used to inflate the weight for subjects who are under-represented due to a large degree of <a href=\"/wiki/Missing_data\" title=\"Missing data\">missing data</a>.\n</p>\n<div id=\"toc\" class=\"toc\"><input type=\"checkbox\" role=\"button\" id=\"toctogglecheckbox\" class=\"toctogglecheckbox\" style=\"display:none\" /><div class=\"toctitle\" lang=\"en\" dir=\"ltr\"><h2>Contents</h2><span class=\"toctogglespan\"><label class=\"toctogglelabel\" for=\"toctogglecheckbox\"></label></span></div>\n<ul>\n<li class=\"toclevel-1 tocsection-1\"><a href=\"#Inverse_Probability_Weighted_Estimator_(IPWE)\"><span class=\"tocnumber\">1</span> <span class=\"toctext\">Inverse Probability Weighted Estimator (IPWE)</span></a>\n<ul>\n<li class=\"toclevel-2 tocsection-2\"><a href=\"#Estimator_Formula\"><span class=\"tocnumber\">1.1</span> <span class=\"toctext\">Estimator Formula</span></a>\n<ul>\n<li class=\"toclevel-3 tocsection-3\"><a href=\"#Constructing_the_IPWE\"><span class=\"tocnumber\">1.1.1</span> <span class=\"toctext\">Constructing the IPWE</span></a></li>\n<li class=\"toclevel-3 tocsection-4\"><a href=\"#Assumptions\"><span class=\"tocnumber\">1.1.2</span> <span class=\"toctext\">Assumptions</span></a></li>\n<li class=\"toclevel-3 tocsection-5\"><a href=\"#Limitations\"><span class=\"tocnumber\">1.1.3</span> <span class=\"toctext\">Limitations</span></a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li class=\"toclevel-1 tocsection-6\"><a href=\"#Augmented_Inverse_Probability_Weighted_Estimator_(AIPWE)\"><span class=\"tocnumber\">2</span> <span class=\"toctext\">Augmented Inverse Probability Weighted Estimator (AIPWE)</span></a>\n<ul>\n<li class=\"toclevel-2 tocsection-7\"><a href=\"#Estimator_Formula_2\"><span class=\"tocnumber\">2.1</span> <span class=\"toctext\">Estimator Formula</span></a>\n<ul>\n<li class=\"toclevel-3 tocsection-8\"><a href=\"#Constructing_the_AIPWE\"><span class=\"tocnumber\">2.1.1</span> <span class=\"toctext\">Constructing the AIPWE</span></a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li class=\"toclevel-1 tocsection-9\"><a href=\"#References\"><span class=\"tocnumber\">3</span> <span class=\"toctext\">References</span></a></li>\n</ul>\n</div>\n\n<h2><span id=\"Inverse_Probability_Weighted_Estimator_.28IPWE.29\"></span><span class=\"mw-headline\" id=\"Inverse_Probability_Weighted_Estimator_(IPWE)\">Inverse Probability Weighted Estimator (IPWE)</span><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/w/index.php?title=Inverse_probability_weighting&amp;action=edit&amp;section=1\" title=\"Edit section: Inverse Probability Weighted Estimator (IPWE)\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></h2>\n<p>The inverse probability weighting estimator can be used to demonstrate causality when the researcher cannot conduct a controlled experiment but has observed data to model. Because it is assumed that the treatment is not randomly assigned, the goal is to estimate the counterfactual or potential outcome if all subjects in population were assigned either treatment.\n</p><p>Suppose observed data are <span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle \\{{\\bigl (}X_{i},A_{i},Y_{i}{\\bigr )}\\}_{i=1}^{n}}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <mo fence=\"false\" stretchy=\"false\">{</mo>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mrow class=\"MJX-TeXAtom-OPEN\">\n            <mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo>\n          </mrow>\n        </mrow>\n        <msub>\n          <mi>X</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>i</mi>\n          </mrow>\n        </msub>\n        <mo>,</mo>\n        <msub>\n          <mi>A</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>i</mi>\n          </mrow>\n        </msub>\n        <mo>,</mo>\n        <msub>\n          <mi>Y</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>i</mi>\n          </mrow>\n        </msub>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mrow class=\"MJX-TeXAtom-CLOSE\">\n            <mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo>\n          </mrow>\n        </mrow>\n        <msubsup>\n          <mo fence=\"false\" stretchy=\"false\">}</mo>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>i</mi>\n            <mo>=</mo>\n            <mn>1</mn>\n          </mrow>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>n</mi>\n          </mrow>\n        </msubsup>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle \\{{\\bigl (}X_{i},A_{i},Y_{i}{\\bigr )}\\}_{i=1}^{n}}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/0abb2f6de74a4243092575e6c8fa00785b6d80f8\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -1.005ex; width:16.84ex; height:3.176ex;\" alt=\"{\\displaystyle \\{{\\bigl (}X_{i},A_{i},Y_{i}{\\bigr )}\\}_{i=1}^{n}}\"/></span> drawn i.i.d from unknown distribution P, where\n</p>\n<ul><li><span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle X\\in \\mathbb {R} ^{p}}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <mi>X</mi>\n        <mo>&#x2208;<!-- \u2208 --></mo>\n        <msup>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi mathvariant=\"double-struck\">R</mi>\n          </mrow>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>p</mi>\n          </mrow>\n        </msup>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle X\\in \\mathbb {R} ^{p}}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/f132d2037abf936c0253f5009a4e65e0e3f28fa9\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -0.338ex; width:7.558ex; height:2.343ex;\" alt=\"{\\displaystyle X\\in \\mathbb {R} ^{p}}\"/></span> covariates</li>\n<li><span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle A\\in \\{0,1\\}}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <mi>A</mi>\n        <mo>&#x2208;<!-- \u2208 --></mo>\n        <mo fence=\"false\" stretchy=\"false\">{</mo>\n        <mn>0</mn>\n        <mo>,</mo>\n        <mn>1</mn>\n        <mo fence=\"false\" stretchy=\"false\">}</mo>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle A\\in \\{0,1\\}}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/d1a9b88d030e702c27bec3881517309d36bc1cc4\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -0.838ex; width:10.268ex; height:2.843ex;\" alt=\"{\\displaystyle A\\in \\{0,1\\}}\"/></span></li>\n<li><span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle Y\\in \\mathbb {R} }\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <mi>Y</mi>\n        <mo>&#x2208;<!-- \u2208 --></mo>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mi mathvariant=\"double-struck\">R</mi>\n        </mrow>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle Y\\in \\mathbb {R} }</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/6a56eca2212648563cb420ea47288c61240024e1\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -0.338ex; width:6.292ex; height:2.176ex;\" alt=\"{\\displaystyle Y\\in \\mathbb {R} }\"/></span> response</li>\n<li>We do not assume treatment randomly assigned completely at random</li></ul>\n<p>The goal is to estimate the potential outcome, <span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle Y^{*}{\\bigl (}a{\\bigr )}}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <msup>\n          <mi>Y</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mo>&#x2217;<!-- \u2217 --></mo>\n          </mrow>\n        </msup>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mrow class=\"MJX-TeXAtom-OPEN\">\n            <mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo>\n          </mrow>\n        </mrow>\n        <mi>a</mi>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mrow class=\"MJX-TeXAtom-CLOSE\">\n            <mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo>\n          </mrow>\n        </mrow>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle Y^{*}{\\bigl (}a{\\bigr )}}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/05a6629e31167819962cc8ee91fb5bde8cda268f\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -1.005ex; width:6.314ex; height:3.176ex;\" alt=\"{\\displaystyle Y^{*}{\\bigl (}a{\\bigr )}}\"/></span>, that would be observed if the subject were assigned treatment a. Then compare the mean outcome if all patients in the population were assigned either treatment: <span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle \\mu _{a}=\\mathbb {E} Y^{*}(a)}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <msub>\n          <mi>&#x03BC;<!-- \u03bc --></mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>a</mi>\n          </mrow>\n        </msub>\n        <mo>=</mo>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mi mathvariant=\"double-struck\">E</mi>\n        </mrow>\n        <msup>\n          <mi>Y</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mo>&#x2217;<!-- \u2217 --></mo>\n          </mrow>\n        </msup>\n        <mo stretchy=\"false\">(</mo>\n        <mi>a</mi>\n        <mo stretchy=\"false\">)</mo>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle \\mu _{a}=\\mathbb {E} Y^{*}(a)}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/0a67b0cec6446a2a45af093b7e5109e65d058470\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -0.838ex; width:13.146ex; height:2.843ex;\" alt=\"{\\displaystyle \\mu _{a}=\\mathbb {E} Y^{*}(a)}\"/></span>. We want to estimate <span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle \\mu _{a}}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <msub>\n          <mi>&#x03BC;<!-- \u03bc --></mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>a</mi>\n          </mrow>\n        </msub>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle \\mu _{a}}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/ea3dc3301612e553675341c662acee2c98f8607f\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -0.838ex; width:2.504ex; height:2.176ex;\" alt=\"\\mu_a\"/></span> using observed data <span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle \\{{\\bigl (}X_{i},A_{i},Y_{i}{\\bigr )}\\}_{i=1}^{n}}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <mo fence=\"false\" stretchy=\"false\">{</mo>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mrow class=\"MJX-TeXAtom-OPEN\">\n            <mo maxsize=\"1.2em\" minsize=\"1.2em\">(</mo>\n          </mrow>\n        </mrow>\n        <msub>\n          <mi>X</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>i</mi>\n          </mrow>\n        </msub>\n        <mo>,</mo>\n        <msub>\n          <mi>A</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>i</mi>\n          </mrow>\n        </msub>\n        <mo>,</mo>\n        <msub>\n          <mi>Y</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>i</mi>\n          </mrow>\n        </msub>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mrow class=\"MJX-TeXAtom-CLOSE\">\n            <mo maxsize=\"1.2em\" minsize=\"1.2em\">)</mo>\n          </mrow>\n        </mrow>\n        <msubsup>\n          <mo fence=\"false\" stretchy=\"false\">}</mo>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>i</mi>\n            <mo>=</mo>\n            <mn>1</mn>\n          </mrow>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>n</mi>\n          </mrow>\n        </msubsup>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle \\{{\\bigl (}X_{i},A_{i},Y_{i}{\\bigr )}\\}_{i=1}^{n}}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/0abb2f6de74a4243092575e6c8fa00785b6d80f8\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -1.005ex; width:16.84ex; height:3.176ex;\" alt=\"{\\displaystyle \\{{\\bigl (}X_{i},A_{i},Y_{i}{\\bigr )}\\}_{i=1}^{n}}\"/></span>.\n</p>\n<h3><span class=\"mw-headline\" id=\"Estimator_Formula\">Estimator Formula</span><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/w/index.php?title=Inverse_probability_weighting&amp;action=edit&amp;section=2\" title=\"Edit section: Estimator Formula\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></h3>\n<blockquote><p><span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle {\\hat {\\mu }}_{a,n}^{IPWE}=n^{-1}\\Sigma _{i=1}^{n}Y_{i}1_{A_{i}=a}/{\\hat {p}}_{n}(A_{i}=a|X_{i})}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <msubsup>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mrow class=\"MJX-TeXAtom-ORD\">\n              <mover>\n                <mi>&#x03BC;<!-- \u03bc --></mi>\n                <mo stretchy=\"false\">&#x005E;<!-- ^ --></mo>\n              </mover>\n            </mrow>\n          </mrow>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>a</mi>\n            <mo>,</mo>\n            <mi>n</mi>\n          </mrow>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>I</mi>\n            <mi>P</mi>\n            <mi>W</mi>\n            <mi>E</mi>\n          </mrow>\n        </msubsup>\n        <mo>=</mo>\n        <msup>\n          <mi>n</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mo>&#x2212;<!-- \u2212 --></mo>\n            <mn>1</mn>\n          </mrow>\n        </msup>\n        <msubsup>\n          <mi mathvariant=\"normal\">&#x03A3;<!-- \u03a3 --></mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>i</mi>\n            <mo>=</mo>\n            <mn>1</mn>\n          </mrow>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>n</mi>\n          </mrow>\n        </msubsup>\n        <msub>\n          <mi>Y</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>i</mi>\n          </mrow>\n        </msub>\n        <msub>\n          <mn>1</mn>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <msub>\n              <mi>A</mi>\n              <mrow class=\"MJX-TeXAtom-ORD\">\n                <mi>i</mi>\n              </mrow>\n            </msub>\n            <mo>=</mo>\n            <mi>a</mi>\n          </mrow>\n        </msub>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mo>/</mo>\n        </mrow>\n        <msub>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mrow class=\"MJX-TeXAtom-ORD\">\n              <mover>\n                <mi>p</mi>\n                <mo stretchy=\"false\">&#x005E;<!-- ^ --></mo>\n              </mover>\n            </mrow>\n          </mrow>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>n</mi>\n          </mrow>\n        </msub>\n        <mo stretchy=\"false\">(</mo>\n        <msub>\n          <mi>A</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>i</mi>\n          </mrow>\n        </msub>\n        <mo>=</mo>\n        <mi>a</mi>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mo stretchy=\"false\">|</mo>\n        </mrow>\n        <msub>\n          <mi>X</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>i</mi>\n          </mrow>\n        </msub>\n        <mo stretchy=\"false\">)</mo>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle {\\hat {\\mu }}_{a,n}^{IPWE}=n^{-1}\\Sigma _{i=1}^{n}Y_{i}1_{A_{i}=a}/{\\hat {p}}_{n}(A_{i}=a|X_{i})}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/89ad880b2dc2eb521a828249baf4689618c35464\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -1.171ex; width:41.421ex; height:3.509ex;\" alt=\"{\\displaystyle {\\hat {\\mu }}_{a,n}^{IPWE}=n^{-1}\\Sigma _{i=1}^{n}Y_{i}1_{A_{i}=a}/{\\hat {p}}_{n}(A_{i}=a|X_{i})}\"/></span></p></blockquote>\n<h4><span class=\"mw-headline\" id=\"Constructing_the_IPWE\">Constructing the IPWE</span><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/w/index.php?title=Inverse_probability_weighting&amp;action=edit&amp;section=3\" title=\"Edit section: Constructing the IPWE\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></h4>\n<ol><li><span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle \\mu _{a}=\\mathbb {E} \\{Y1_{A=a}/p(A|X)\\}}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <msub>\n          <mi>&#x03BC;<!-- \u03bc --></mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>a</mi>\n          </mrow>\n        </msub>\n        <mo>=</mo>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mi mathvariant=\"double-struck\">E</mi>\n        </mrow>\n        <mo fence=\"false\" stretchy=\"false\">{</mo>\n        <mi>Y</mi>\n        <msub>\n          <mn>1</mn>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>A</mi>\n            <mo>=</mo>\n            <mi>a</mi>\n          </mrow>\n        </msub>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mo>/</mo>\n        </mrow>\n        <mi>p</mi>\n        <mo stretchy=\"false\">(</mo>\n        <mi>A</mi>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mo stretchy=\"false\">|</mo>\n        </mrow>\n        <mi>X</mi>\n        <mo stretchy=\"false\">)</mo>\n        <mo fence=\"false\" stretchy=\"false\">}</mo>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle \\mu _{a}=\\mathbb {E} \\{Y1_{A=a}/p(A|X)\\}}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/73319a823ed9eff46507aa80504664b93752e12f\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -0.838ex; width:24.537ex; height:2.843ex;\" alt=\"{\\displaystyle \\mu _{a}=\\mathbb {E} \\{Y1_{A=a}/p(A|X)\\}}\"/></span>   where <span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle p(a|x)=P(A=a,X=x)}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <mi>p</mi>\n        <mo stretchy=\"false\">(</mo>\n        <mi>a</mi>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mo stretchy=\"false\">|</mo>\n        </mrow>\n        <mi>x</mi>\n        <mo stretchy=\"false\">)</mo>\n        <mo>=</mo>\n        <mi>P</mi>\n        <mo stretchy=\"false\">(</mo>\n        <mi>A</mi>\n        <mo>=</mo>\n        <mi>a</mi>\n        <mo>,</mo>\n        <mi>X</mi>\n        <mo>=</mo>\n        <mi>x</mi>\n        <mo stretchy=\"false\">)</mo>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle p(a|x)=P(A=a,X=x)}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/e23203c559377d11db4542d6486043d5728ac6f1\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -0.838ex; margin-left: -0.089ex; width:26.441ex; height:2.843ex;\" alt=\"{\\displaystyle p(a|x)=P(A=a,X=x)}\"/></span> <span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle A}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <mi>A</mi>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle A}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/7daff47fa58cdfd29dc333def748ff5fa4c923e3\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -0.338ex; width:1.743ex; height:2.176ex;\" alt=\"A\"/></span></li>\n<li>construct <span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle {\\hat {p}}_{n}(a|x)}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <msub>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mrow class=\"MJX-TeXAtom-ORD\">\n              <mover>\n                <mi>p</mi>\n                <mo stretchy=\"false\">&#x005E;<!-- ^ --></mo>\n              </mover>\n            </mrow>\n          </mrow>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>n</mi>\n          </mrow>\n        </msub>\n        <mo stretchy=\"false\">(</mo>\n        <mi>a</mi>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mo stretchy=\"false\">|</mo>\n        </mrow>\n        <mi>x</mi>\n        <mo stretchy=\"false\">)</mo>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle {\\hat {p}}_{n}(a|x)}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/630f98fa81213d1e8d370267b1a37ede15b571a4\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -0.838ex; margin-left: -0.089ex; width:7.683ex; height:2.843ex;\" alt=\"{\\displaystyle {\\hat {p}}_{n}(a|x)}\"/></span> of <span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle p(a|x)}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <mi>p</mi>\n        <mo stretchy=\"false\">(</mo>\n        <mi>a</mi>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mo stretchy=\"false\">|</mo>\n        </mrow>\n        <mi>x</mi>\n        <mo stretchy=\"false\">)</mo>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle p(a|x)}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/cf9ccf918c74a67dd19699401b1dbdebed834e0a\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -0.838ex; margin-left: -0.089ex; width:6.274ex; height:2.843ex;\" alt=\"{\\displaystyle p(a|x)}\"/></span> using any propensity model (often a logistic regression model)</li>\n<li><span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle {\\hat {\\mu }}_{a,n}^{IPWE}=n^{-1}\\Sigma _{i=1}^{n}Y_{i}1_{A_{i}=a}/{\\hat {p}}_{n}(A_{i}|X_{i})}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <msubsup>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mrow class=\"MJX-TeXAtom-ORD\">\n              <mover>\n                <mi>&#x03BC;<!-- \u03bc --></mi>\n                <mo stretchy=\"false\">&#x005E;<!-- ^ --></mo>\n              </mover>\n            </mrow>\n          </mrow>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>a</mi>\n            <mo>,</mo>\n            <mi>n</mi>\n          </mrow>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>I</mi>\n            <mi>P</mi>\n            <mi>W</mi>\n            <mi>E</mi>\n          </mrow>\n        </msubsup>\n        <mo>=</mo>\n        <msup>\n          <mi>n</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mo>&#x2212;<!-- \u2212 --></mo>\n            <mn>1</mn>\n          </mrow>\n        </msup>\n        <msubsup>\n          <mi mathvariant=\"normal\">&#x03A3;<!-- \u03a3 --></mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>i</mi>\n            <mo>=</mo>\n            <mn>1</mn>\n          </mrow>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>n</mi>\n          </mrow>\n        </msubsup>\n        <msub>\n          <mi>Y</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>i</mi>\n          </mrow>\n        </msub>\n        <msub>\n          <mn>1</mn>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <msub>\n              <mi>A</mi>\n              <mrow class=\"MJX-TeXAtom-ORD\">\n                <mi>i</mi>\n              </mrow>\n            </msub>\n            <mo>=</mo>\n            <mi>a</mi>\n          </mrow>\n        </msub>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mo>/</mo>\n        </mrow>\n        <msub>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mrow class=\"MJX-TeXAtom-ORD\">\n              <mover>\n                <mi>p</mi>\n                <mo stretchy=\"false\">&#x005E;<!-- ^ --></mo>\n              </mover>\n            </mrow>\n          </mrow>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>n</mi>\n          </mrow>\n        </msub>\n        <mo stretchy=\"false\">(</mo>\n        <msub>\n          <mi>A</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>i</mi>\n          </mrow>\n        </msub>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mo stretchy=\"false\">|</mo>\n        </mrow>\n        <msub>\n          <mi>X</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>i</mi>\n          </mrow>\n        </msub>\n        <mo stretchy=\"false\">)</mo>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle {\\hat {\\mu }}_{a,n}^{IPWE}=n^{-1}\\Sigma _{i=1}^{n}Y_{i}1_{A_{i}=a}/{\\hat {p}}_{n}(A_{i}|X_{i})}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/448f3cf4377ada35f49a10afce84cabd599ca02a\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -1.171ex; width:37.092ex; height:3.509ex;\" alt=\"{\\displaystyle {\\hat {\\mu }}_{a,n}^{IPWE}=n^{-1}\\Sigma _{i=1}^{n}Y_{i}1_{A_{i}=a}/{\\hat {p}}_{n}(A_{i}|X_{i})}\"/></span></li></ol>\n<p>With the mean of each treatment group computed, a statistical t-test or ANOVA test can be used to judge difference between group means and determine statistical significance of treatment effect.\n</p>\n<h4><span class=\"mw-headline\" id=\"Assumptions\">Assumptions</span><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/w/index.php?title=Inverse_probability_weighting&amp;action=edit&amp;section=4\" title=\"Edit section: Assumptions\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></h4>\n<ol><li>Consistency: <span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle Y=Y^{*}(A)}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <mi>Y</mi>\n        <mo>=</mo>\n        <msup>\n          <mi>Y</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mo>&#x2217;<!-- \u2217 --></mo>\n          </mrow>\n        </msup>\n        <mo stretchy=\"false\">(</mo>\n        <mi>A</mi>\n        <mo stretchy=\"false\">)</mo>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle Y=Y^{*}(A)}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/35f0be7d9774057b18305f7513693146494f949a\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -0.838ex; width:11.379ex; height:2.843ex;\" alt=\"{\\displaystyle Y=Y^{*}(A)}\"/></span></li>\n<li>No unmeasured confounders: <span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle \\{Y^{*}(0),Y^{*}(1)\\}\\perp A|X}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <mo fence=\"false\" stretchy=\"false\">{</mo>\n        <msup>\n          <mi>Y</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mo>&#x2217;<!-- \u2217 --></mo>\n          </mrow>\n        </msup>\n        <mo stretchy=\"false\">(</mo>\n        <mn>0</mn>\n        <mo stretchy=\"false\">)</mo>\n        <mo>,</mo>\n        <msup>\n          <mi>Y</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mo>&#x2217;<!-- \u2217 --></mo>\n          </mrow>\n        </msup>\n        <mo stretchy=\"false\">(</mo>\n        <mn>1</mn>\n        <mo stretchy=\"false\">)</mo>\n        <mo fence=\"false\" stretchy=\"false\">}</mo>\n        <mo>&#x22A5;<!-- \u22a5 --></mo>\n        <mi>A</mi>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mo stretchy=\"false\">|</mo>\n        </mrow>\n        <mi>X</mi>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle \\{Y^{*}(0),Y^{*}(1)\\}\\perp A|X}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/121da42452a3138200b5a29ad47eede4ccb15954\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -0.838ex; width:22.68ex; height:2.843ex;\" alt=\"{\\displaystyle \\{Y^{*}(0),Y^{*}(1)\\}\\perp A|X}\"/></span>\n<ul><li>Treatment assignment is based solely on covariate data and independent of potential outcomes.</li></ul></li>\n<li>Positivity: <span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle P(A=a|X=x)&gt;0}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <mi>P</mi>\n        <mo stretchy=\"false\">(</mo>\n        <mi>A</mi>\n        <mo>=</mo>\n        <mi>a</mi>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mo stretchy=\"false\">|</mo>\n        </mrow>\n        <mi>X</mi>\n        <mo>=</mo>\n        <mi>x</mi>\n        <mo stretchy=\"false\">)</mo>\n        <mo>&gt;</mo>\n        <mn>0</mn>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle P(A=a|X=x)&gt;0}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/09e4bfe2b556f79d261623c97ca88a3fd4b132f6\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -0.838ex; width:20.942ex; height:2.843ex;\" alt=\"{\\displaystyle P(A=a|X=x)&gt;0}\"/></span> for all <span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle a}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <mi>a</mi>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle a}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/ffd2487510aa438433a2579450ab2b3d557e5edc\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -0.338ex; width:1.23ex; height:1.676ex;\" alt=\"a\"/></span> and <span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle x}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <mi>x</mi>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle x}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/87f9e315fd7e2ba406057a97300593c4802b53e4\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -0.338ex; width:1.33ex; height:1.676ex;\" alt=\"x\"/></span></li></ol>\n<h4><span class=\"mw-headline\" id=\"Limitations\">Limitations</span><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/w/index.php?title=Inverse_probability_weighting&amp;action=edit&amp;section=5\" title=\"Edit section: Limitations\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></h4>\n<p>The Inverse Probability Weighted Estimator (IPWE) can be unstable if estimated propensities are small. If the probability of either treatment assignment is small, then the logistic regression model can become unstable around the tails causing the IPWE to also be less stable.\n</p>\n<h2><span id=\"Augmented_Inverse_Probability_Weighted_Estimator_.28AIPWE.29\"></span><span class=\"mw-headline\" id=\"Augmented_Inverse_Probability_Weighted_Estimator_(AIPWE)\">Augmented Inverse Probability Weighted Estimator (AIPWE)</span><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/w/index.php?title=Inverse_probability_weighting&amp;action=edit&amp;section=6\" title=\"Edit section: Augmented Inverse Probability Weighted Estimator (AIPWE)\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></h2>\n<p>An alternative estimator is the augmented inverse probability weighted estimator (AIPWE) combines both the properties of the regression based estimator and the inverse probability weighted estimator. It is therefore a 'doubly robust' method in that it only requires either the propensity or outcome model to be correctly specified but not both. This method augments the IPWE to reduce variability and improve estimate efficiency. This model holds the same assumptions as the Inverse Probability Weighted Estimator (IPWE).<sup id=\"cite_ref-5\" class=\"reference\"><a href=\"#cite_note-5\">&#91;5&#93;</a></sup>\n</p>\n<h3><span class=\"mw-headline\" id=\"Estimator_Formula_2\">Estimator Formula</span><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/w/index.php?title=Inverse_probability_weighting&amp;action=edit&amp;section=7\" title=\"Edit section: Estimator Formula\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></h3>\n<blockquote><p><span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle {\\hat {\\mu }}_{a,n}^{AIPWE}={\\frac {1}{n}}\\sum _{i=1}^{n}{\\Biggl (}{\\frac {Y_{i}1_{A_{i}=a}}{{\\hat {p}}_{n}(A_{i}|X_{i})}}-{\\frac {1_{A_{i}=a}-{\\hat {p}}_{n}(A_{i}|X_{i})}{{\\hat {p}}_{n}(A_{i}|X_{i})}}{\\hat {Q}}_{n}(X_{i},a){\\Biggr )}}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <msubsup>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mrow class=\"MJX-TeXAtom-ORD\">\n              <mover>\n                <mi>&#x03BC;<!-- \u03bc --></mi>\n                <mo stretchy=\"false\">&#x005E;<!-- ^ --></mo>\n              </mover>\n            </mrow>\n          </mrow>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>a</mi>\n            <mo>,</mo>\n            <mi>n</mi>\n          </mrow>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>A</mi>\n            <mi>I</mi>\n            <mi>P</mi>\n            <mi>W</mi>\n            <mi>E</mi>\n          </mrow>\n        </msubsup>\n        <mo>=</mo>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mfrac>\n            <mn>1</mn>\n            <mi>n</mi>\n          </mfrac>\n        </mrow>\n        <munderover>\n          <mo>&#x2211;<!-- \u2211 --></mo>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>i</mi>\n            <mo>=</mo>\n            <mn>1</mn>\n          </mrow>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>n</mi>\n          </mrow>\n        </munderover>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mrow class=\"MJX-TeXAtom-OPEN\">\n            <mo maxsize=\"2.470em\" minsize=\"2.470em\">(</mo>\n          </mrow>\n        </mrow>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mfrac>\n            <mrow>\n              <msub>\n                <mi>Y</mi>\n                <mrow class=\"MJX-TeXAtom-ORD\">\n                  <mi>i</mi>\n                </mrow>\n              </msub>\n              <msub>\n                <mn>1</mn>\n                <mrow class=\"MJX-TeXAtom-ORD\">\n                  <msub>\n                    <mi>A</mi>\n                    <mrow class=\"MJX-TeXAtom-ORD\">\n                      <mi>i</mi>\n                    </mrow>\n                  </msub>\n                  <mo>=</mo>\n                  <mi>a</mi>\n                </mrow>\n              </msub>\n            </mrow>\n            <mrow>\n              <msub>\n                <mrow class=\"MJX-TeXAtom-ORD\">\n                  <mrow class=\"MJX-TeXAtom-ORD\">\n                    <mover>\n                      <mi>p</mi>\n                      <mo stretchy=\"false\">&#x005E;<!-- ^ --></mo>\n                    </mover>\n                  </mrow>\n                </mrow>\n                <mrow class=\"MJX-TeXAtom-ORD\">\n                  <mi>n</mi>\n                </mrow>\n              </msub>\n              <mo stretchy=\"false\">(</mo>\n              <msub>\n                <mi>A</mi>\n                <mrow class=\"MJX-TeXAtom-ORD\">\n                  <mi>i</mi>\n                </mrow>\n              </msub>\n              <mrow class=\"MJX-TeXAtom-ORD\">\n                <mo stretchy=\"false\">|</mo>\n              </mrow>\n              <msub>\n                <mi>X</mi>\n                <mrow class=\"MJX-TeXAtom-ORD\">\n                  <mi>i</mi>\n                </mrow>\n              </msub>\n              <mo stretchy=\"false\">)</mo>\n            </mrow>\n          </mfrac>\n        </mrow>\n        <mo>&#x2212;<!-- \u2212 --></mo>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mfrac>\n            <mrow>\n              <msub>\n                <mn>1</mn>\n                <mrow class=\"MJX-TeXAtom-ORD\">\n                  <msub>\n                    <mi>A</mi>\n                    <mrow class=\"MJX-TeXAtom-ORD\">\n                      <mi>i</mi>\n                    </mrow>\n                  </msub>\n                  <mo>=</mo>\n                  <mi>a</mi>\n                </mrow>\n              </msub>\n              <mo>&#x2212;<!-- \u2212 --></mo>\n              <msub>\n                <mrow class=\"MJX-TeXAtom-ORD\">\n                  <mrow class=\"MJX-TeXAtom-ORD\">\n                    <mover>\n                      <mi>p</mi>\n                      <mo stretchy=\"false\">&#x005E;<!-- ^ --></mo>\n                    </mover>\n                  </mrow>\n                </mrow>\n                <mrow class=\"MJX-TeXAtom-ORD\">\n                  <mi>n</mi>\n                </mrow>\n              </msub>\n              <mo stretchy=\"false\">(</mo>\n              <msub>\n                <mi>A</mi>\n                <mrow class=\"MJX-TeXAtom-ORD\">\n                  <mi>i</mi>\n                </mrow>\n              </msub>\n              <mrow class=\"MJX-TeXAtom-ORD\">\n                <mo stretchy=\"false\">|</mo>\n              </mrow>\n              <msub>\n                <mi>X</mi>\n                <mrow class=\"MJX-TeXAtom-ORD\">\n                  <mi>i</mi>\n                </mrow>\n              </msub>\n              <mo stretchy=\"false\">)</mo>\n            </mrow>\n            <mrow>\n              <msub>\n                <mrow class=\"MJX-TeXAtom-ORD\">\n                  <mrow class=\"MJX-TeXAtom-ORD\">\n                    <mover>\n                      <mi>p</mi>\n                      <mo stretchy=\"false\">&#x005E;<!-- ^ --></mo>\n                    </mover>\n                  </mrow>\n                </mrow>\n                <mrow class=\"MJX-TeXAtom-ORD\">\n                  <mi>n</mi>\n                </mrow>\n              </msub>\n              <mo stretchy=\"false\">(</mo>\n              <msub>\n                <mi>A</mi>\n                <mrow class=\"MJX-TeXAtom-ORD\">\n                  <mi>i</mi>\n                </mrow>\n              </msub>\n              <mrow class=\"MJX-TeXAtom-ORD\">\n                <mo stretchy=\"false\">|</mo>\n              </mrow>\n              <msub>\n                <mi>X</mi>\n                <mrow class=\"MJX-TeXAtom-ORD\">\n                  <mi>i</mi>\n                </mrow>\n              </msub>\n              <mo stretchy=\"false\">)</mo>\n            </mrow>\n          </mfrac>\n        </mrow>\n        <msub>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mrow class=\"MJX-TeXAtom-ORD\">\n              <mover>\n                <mi>Q</mi>\n                <mo stretchy=\"false\">&#x005E;<!-- ^ --></mo>\n              </mover>\n            </mrow>\n          </mrow>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>n</mi>\n          </mrow>\n        </msub>\n        <mo stretchy=\"false\">(</mo>\n        <msub>\n          <mi>X</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>i</mi>\n          </mrow>\n        </msub>\n        <mo>,</mo>\n        <mi>a</mi>\n        <mo stretchy=\"false\">)</mo>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mrow class=\"MJX-TeXAtom-CLOSE\">\n            <mo maxsize=\"2.470em\" minsize=\"2.470em\">)</mo>\n          </mrow>\n        </mrow>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle {\\hat {\\mu }}_{a,n}^{AIPWE}={\\frac {1}{n}}\\sum _{i=1}^{n}{\\Biggl (}{\\frac {Y_{i}1_{A_{i}=a}}{{\\hat {p}}_{n}(A_{i}|X_{i})}}-{\\frac {1_{A_{i}=a}-{\\hat {p}}_{n}(A_{i}|X_{i})}{{\\hat {p}}_{n}(A_{i}|X_{i})}}{\\hat {Q}}_{n}(X_{i},a){\\Biggr )}}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/928270e2a337bceaf7ec0acaf9c9d3bf9a7bba38\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -3.171ex; width:64.255ex; height:7.509ex;\" alt=\"{\\displaystyle {\\hat {\\mu }}_{a,n}^{AIPWE}={\\frac {1}{n}}\\sum _{i=1}^{n}{\\Biggl (}{\\frac {Y_{i}1_{A_{i}=a}}{{\\hat {p}}_{n}(A_{i}|X_{i})}}-{\\frac {1_{A_{i}=a}-{\\hat {p}}_{n}(A_{i}|X_{i})}{{\\hat {p}}_{n}(A_{i}|X_{i})}}{\\hat {Q}}_{n}(X_{i},a){\\Biggr )}}\"/></span></p></blockquote>\n<h4><span class=\"mw-headline\" id=\"Constructing_the_AIPWE\">Constructing the AIPWE</span><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/w/index.php?title=Inverse_probability_weighting&amp;action=edit&amp;section=8\" title=\"Edit section: Constructing the AIPWE\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></h4>\n<ol><li>Construct regression estimator <span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle {\\hat {Q}}_{n}(x,a)}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <msub>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mrow class=\"MJX-TeXAtom-ORD\">\n              <mover>\n                <mi>Q</mi>\n                <mo stretchy=\"false\">&#x005E;<!-- ^ --></mo>\n              </mover>\n            </mrow>\n          </mrow>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>n</mi>\n          </mrow>\n        </msub>\n        <mo stretchy=\"false\">(</mo>\n        <mi>x</mi>\n        <mo>,</mo>\n        <mi>a</mi>\n        <mo stretchy=\"false\">)</mo>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle {\\hat {Q}}_{n}(x,a)}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/9dd2ed6fffb36817f047206830ca4c9416a14f4a\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -0.838ex; width:8.46ex; height:3.343ex;\" alt=\"{\\displaystyle {\\hat {Q}}_{n}(x,a)}\"/></span> to predict outcome <span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle Y}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <mi>Y</mi>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle Y}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/961d67d6b454b4df2301ac571808a3538b3a6d3f\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -0.171ex; width:1.773ex; height:2.009ex;\" alt=\"Y\"/></span> based on covariates <span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle X}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <mi>X</mi>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle X}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/68baa052181f707c662844a465bfeeb135e82bab\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -0.338ex; width:1.98ex; height:2.176ex;\" alt=\"X\"/></span> and treatment <span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle A}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <mi>A</mi>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle A}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/7daff47fa58cdfd29dc333def748ff5fa4c923e3\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -0.338ex; width:1.743ex; height:2.176ex;\" alt=\"A\"/></span></li>\n<li>Construct propensity estimate <span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle {\\hat {p}}_{n}(A_{i}|X_{i})}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <msub>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mrow class=\"MJX-TeXAtom-ORD\">\n              <mover>\n                <mi>p</mi>\n                <mo stretchy=\"false\">&#x005E;<!-- ^ --></mo>\n              </mover>\n            </mrow>\n          </mrow>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>n</mi>\n          </mrow>\n        </msub>\n        <mo stretchy=\"false\">(</mo>\n        <msub>\n          <mi>A</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>i</mi>\n          </mrow>\n        </msub>\n        <mrow class=\"MJX-TeXAtom-ORD\">\n          <mo stretchy=\"false\">|</mo>\n        </mrow>\n        <msub>\n          <mi>X</mi>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>i</mi>\n          </mrow>\n        </msub>\n        <mo stretchy=\"false\">)</mo>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle {\\hat {p}}_{n}(A_{i}|X_{i})}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/0a01664082f61ec86cadc22e9f3db5091dea419f\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -0.838ex; margin-left: -0.089ex; width:10.39ex; height:2.843ex;\" alt=\"{\\displaystyle {\\hat {p}}_{n}(A_{i}|X_{i})}\"/></span></li>\n<li>Combine in AIPWE to obtain <span class=\"mwe-math-element\"><span class=\"mwe-math-mathml-inline mwe-math-mathml-a11y\" style=\"display: none;\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"  alttext=\"{\\displaystyle {\\hat {\\mu }}_{a,n}^{AIPWE}}\">\n  <semantics>\n    <mrow class=\"MJX-TeXAtom-ORD\">\n      <mstyle displaystyle=\"true\" scriptlevel=\"0\">\n        <msubsup>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mrow class=\"MJX-TeXAtom-ORD\">\n              <mover>\n                <mi>&#x03BC;<!-- \u03bc --></mi>\n                <mo stretchy=\"false\">&#x005E;<!-- ^ --></mo>\n              </mover>\n            </mrow>\n          </mrow>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>a</mi>\n            <mo>,</mo>\n            <mi>n</mi>\n          </mrow>\n          <mrow class=\"MJX-TeXAtom-ORD\">\n            <mi>A</mi>\n            <mi>I</mi>\n            <mi>P</mi>\n            <mi>W</mi>\n            <mi>E</mi>\n          </mrow>\n        </msubsup>\n      </mstyle>\n    </mrow>\n    <annotation encoding=\"application/x-tex\">{\\displaystyle {\\hat {\\mu }}_{a,n}^{AIPWE}}</annotation>\n  </semantics>\n</math></span><img src=\"https://wikimedia.org/api/rest_v1/media/math/render/svg/e317db56783654340ec8ca4d1acf0c177d7b781b\" class=\"mwe-math-fallback-image-inline\" aria-hidden=\"true\" style=\"vertical-align: -1.171ex; width:7.907ex; height:3.676ex;\" alt=\"{\\displaystyle {\\hat {\\mu }}_{a,n}^{AIPWE}}\"/></span></li></ol>\n<h2><span class=\"mw-headline\" id=\"References\">References</span><span class=\"mw-editsection\"><span class=\"mw-editsection-bracket\">[</span><a href=\"/w/index.php?title=Inverse_probability_weighting&amp;action=edit&amp;section=9\" title=\"Edit section: References\">edit</a><span class=\"mw-editsection-bracket\">]</span></span></h2>\n<div class=\"reflist\" style=\"list-style-type: decimal;\">\n<div class=\"mw-references-wrap\"><ol class=\"references\">\n<li id=\"cite_note-refname2-1\"><span class=\"mw-cite-backlink\"><b><a href=\"#cite_ref-refname2_1-0\">^</a></b></span> <span class=\"reference-text\">\n<cite class=\"citation journal\">Robins, JM; Rotnitzky, A; Zhao, LP (1994). \"Estimation of regression coefficients when some regressors are not always observed\". <i><a href=\"/wiki/Journal_of_the_American_Statistical_Association\" title=\"Journal of the American Statistical Association\">Journal of the American Statistical Association</a></i>. <b>89</b> (427): 846\u2013866. <a href=\"/wiki/Digital_object_identifier\" title=\"Digital object identifier\">doi</a>:<a rel=\"nofollow\" class=\"external text\" href=\"//doi.org/10.1080/01621459.1994.10476818\">10.1080/01621459.1994.10476818</a>.</cite><span title=\"ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.genre=article&amp;rft.jtitle=Journal+of+the+American+Statistical+Association&amp;rft.atitle=Estimation+of+regression+coefficients+when+some+regressors+are+not+always+observed&amp;rft.volume=89&amp;rft.issue=427&amp;rft.pages=846-866&amp;rft.date=1994&amp;rft_id=info%3Adoi%2F10.1080%2F01621459.1994.10476818&amp;rft.aulast=Robins&amp;rft.aufirst=JM&amp;rft.au=Rotnitzky%2C+A&amp;rft.au=Zhao%2C+LP&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AInverse+probability+weighting\" class=\"Z3988\"><span style=\"display:none;\">&#160;</span></span></span>\n</li>\n<li id=\"cite_note-refname3-2\"><span class=\"mw-cite-backlink\"><b><a href=\"#cite_ref-refname3_2-0\">^</a></b></span> <span class=\"reference-text\">\n<cite class=\"citation journal\">Breslow, NE; Lumley, T;  et al. (2009). <a rel=\"nofollow\" class=\"external text\" href=\"//www.ncbi.nlm.nih.gov/pmc/articles/PMC2768499\">\"Using the Whole Cohort in the Analysis of Case-Cohort Data\"</a>. <i>Am J Epidemiol</i>. <b>169</b> (11): 1398\u20131405. <a href=\"/wiki/Digital_object_identifier\" title=\"Digital object identifier\">doi</a>:<a rel=\"nofollow\" class=\"external text\" href=\"//doi.org/10.1093/aje/kwp055\">10.1093/aje/kwp055</a>. <a href=\"/wiki/PubMed_Central\" title=\"PubMed Central\">PMC</a>&#160;<span class=\"plainlinks\"><a rel=\"nofollow\" class=\"external text\" href=\"//www.ncbi.nlm.nih.gov/pmc/articles/PMC2768499\">2768499</a>&#8239;<img alt=\"Freely accessible\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/6/65/Lock-green.svg/9px-Lock-green.svg.png\" title=\"Freely accessible\" width=\"9\" height=\"14\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/6/65/Lock-green.svg/14px-Lock-green.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/6/65/Lock-green.svg/18px-Lock-green.svg.png 2x\" data-file-width=\"512\" data-file-height=\"813\" /></span>. <a href=\"/wiki/PubMed_Identifier\" class=\"mw-redirect\" title=\"PubMed Identifier\">PMID</a>&#160;<a rel=\"nofollow\" class=\"external text\" href=\"//www.ncbi.nlm.nih.gov/pubmed/19357328\">19357328</a>.</cite><span title=\"ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.genre=article&amp;rft.jtitle=Am+J+Epidemiol&amp;rft.atitle=Using+the+Whole+Cohort+in+the+Analysis+of+Case-Cohort+Data&amp;rft.volume=169&amp;rft.issue=11&amp;rft.pages=1398-1405&amp;rft.date=2009&amp;rft_id=%2F%2Fwww.ncbi.nlm.nih.gov%2Fpmc%2Farticles%2FPMC2768499&amp;rft_id=info%3Apmid%2F19357328&amp;rft_id=info%3Adoi%2F10.1093%2Faje%2Fkwp055&amp;rft.aulast=Breslow&amp;rft.aufirst=NE&amp;rft.au=Lumley%2C+T&amp;rft_id=%2F%2Fwww.ncbi.nlm.nih.gov%2Fpmc%2Farticles%2FPMC2768499&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AInverse+probability+weighting\" class=\"Z3988\"><span style=\"display:none;\">&#160;</span></span></span>\n</li>\n<li id=\"cite_note-3\"><span class=\"mw-cite-backlink\"><b><a href=\"#cite_ref-3\">^</a></b></span> <span class=\"reference-text\"><cite class=\"citation journal\">Horvitz, D. G.; Thompson, D. J. (1952). \"A generalization of sampling without replacement from a finite universe\". <i><a href=\"/wiki/Journal_of_the_American_Statistical_Association\" title=\"Journal of the American Statistical Association\">Journal of the American Statistical Association</a></i>. <b>47</b>: 663\u2013685. <a href=\"/wiki/Digital_object_identifier\" title=\"Digital object identifier\">doi</a>:<a rel=\"nofollow\" class=\"external text\" href=\"//doi.org/10.1080/01621459.1952.10483446\">10.1080/01621459.1952.10483446</a>.</cite><span title=\"ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.genre=article&amp;rft.jtitle=Journal+of+the+American+Statistical+Association&amp;rft.atitle=A+generalization+of+sampling+without+replacement+from+a+finite+universe&amp;rft.volume=47&amp;rft.pages=663-685&amp;rft.date=1952&amp;rft_id=info%3Adoi%2F10.1080%2F01621459.1952.10483446&amp;rft.aulast=Horvitz&amp;rft.aufirst=D.+G.&amp;rft.au=Thompson%2C+D.+J.&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AInverse+probability+weighting\" class=\"Z3988\"><span style=\"display:none;\">&#160;</span></span></span>\n</li>\n<li id=\"cite_note-refname1-4\"><span class=\"mw-cite-backlink\"><b><a href=\"#cite_ref-refname1_4-0\">^</a></b></span> <span class=\"reference-text\">\n<cite class=\"citation journal\">Hernan, MA; Robins, JM (2006). <a rel=\"nofollow\" class=\"external text\" href=\"//www.ncbi.nlm.nih.gov/pmc/articles/PMC2652882\">\"Estimating Causal Effects From Epidemiological Data\"</a>. <i>J Epi Comm</i>. <b>60</b>: 578\u2013596. <a href=\"/wiki/CiteSeerX\" title=\"CiteSeerX\">CiteSeerX</a>&#160;<span class=\"plainlinks\"><a rel=\"nofollow\" class=\"external text\" href=\"//citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.157.9366\">10.1.1.157.9366</a>&#8239;<img alt=\"Freely accessible\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/6/65/Lock-green.svg/9px-Lock-green.svg.png\" title=\"Freely accessible\" width=\"9\" height=\"14\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/6/65/Lock-green.svg/14px-Lock-green.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/6/65/Lock-green.svg/18px-Lock-green.svg.png 2x\" data-file-width=\"512\" data-file-height=\"813\" /></span>. <a href=\"/wiki/Digital_object_identifier\" title=\"Digital object identifier\">doi</a>:<a rel=\"nofollow\" class=\"external text\" href=\"//doi.org/10.1136/jech.2004.029496\">10.1136/jech.2004.029496</a>. <a href=\"/wiki/PubMed_Central\" title=\"PubMed Central\">PMC</a>&#160;<span class=\"plainlinks\"><a rel=\"nofollow\" class=\"external text\" href=\"//www.ncbi.nlm.nih.gov/pmc/articles/PMC2652882\">2652882</a>&#8239;<img alt=\"Freely accessible\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/6/65/Lock-green.svg/9px-Lock-green.svg.png\" title=\"Freely accessible\" width=\"9\" height=\"14\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/6/65/Lock-green.svg/14px-Lock-green.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/6/65/Lock-green.svg/18px-Lock-green.svg.png 2x\" data-file-width=\"512\" data-file-height=\"813\" /></span>.</cite><span title=\"ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.genre=article&amp;rft.jtitle=J+Epi+Comm&amp;rft.atitle=Estimating+Causal+Effects+From+Epidemiological+Data&amp;rft.volume=60&amp;rft.pages=578-596&amp;rft.date=2006&amp;rft_id=%2F%2Fciteseerx.ist.psu.edu%2Fviewdoc%2Fsummary%3Fdoi%3D10.1.1.157.9366&amp;rft_id=%2F%2Fwww.ncbi.nlm.nih.gov%2Fpmc%2Farticles%2FPMC2652882&amp;rft_id=info%3Adoi%2F10.1136%2Fjech.2004.029496&amp;rft.aulast=Hernan&amp;rft.aufirst=MA&amp;rft.au=Robins%2C+JM&amp;rft_id=%2F%2Fwww.ncbi.nlm.nih.gov%2Fpmc%2Farticles%2FPMC2652882&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AInverse+probability+weighting\" class=\"Z3988\"><span style=\"display:none;\">&#160;</span></span></span>\n</li>\n<li id=\"cite_note-5\"><span class=\"mw-cite-backlink\"><b><a href=\"#cite_ref-5\">^</a></b></span> <span class=\"reference-text\"><cite class=\"citation journal\">Cao, Weihua; Tsiatis, Anastasios A.; <a href=\"/wiki/Marie_Davidian\" title=\"Marie Davidian\">Davidian, Marie</a> (2009). <a rel=\"nofollow\" class=\"external text\" href=\"//www.ncbi.nlm.nih.gov/pmc/articles/PMC2798744\">\"Improving efficiency and robustness of the doubly robust estimator for a population mean with incomplete data\"</a>. <i>Biometrika</i>. <b>96</b> (3): 723\u2013734. <a href=\"/wiki/Digital_object_identifier\" title=\"Digital object identifier\">doi</a>:<a rel=\"nofollow\" class=\"external text\" href=\"//doi.org/10.1093/biomet/asp033\">10.1093/biomet/asp033</a>. <a href=\"/wiki/International_Standard_Serial_Number\" title=\"International Standard Serial Number\">ISSN</a>&#160;<a rel=\"nofollow\" class=\"external text\" href=\"//www.worldcat.org/issn/0006-3444\">0006-3444</a>. <a href=\"/wiki/PubMed_Central\" title=\"PubMed Central\">PMC</a>&#160;<span class=\"plainlinks\"><a rel=\"nofollow\" class=\"external text\" href=\"//www.ncbi.nlm.nih.gov/pmc/articles/PMC2798744\">2798744</a>&#8239;<img alt=\"Freely accessible\" src=\"//upload.wikimedia.org/wikipedia/commons/thumb/6/65/Lock-green.svg/9px-Lock-green.svg.png\" title=\"Freely accessible\" width=\"9\" height=\"14\" srcset=\"//upload.wikimedia.org/wikipedia/commons/thumb/6/65/Lock-green.svg/14px-Lock-green.svg.png 1.5x, //upload.wikimedia.org/wikipedia/commons/thumb/6/65/Lock-green.svg/18px-Lock-green.svg.png 2x\" data-file-width=\"512\" data-file-height=\"813\" /></span>. <a href=\"/wiki/PubMed_Identifier\" class=\"mw-redirect\" title=\"PubMed Identifier\">PMID</a>&#160;<a rel=\"nofollow\" class=\"external text\" href=\"//www.ncbi.nlm.nih.gov/pubmed/20161511\">20161511</a>.</cite><span title=\"ctx_ver=Z39.88-2004&amp;rft_val_fmt=info%3Aofi%2Ffmt%3Akev%3Amtx%3Ajournal&amp;rft.genre=article&amp;rft.jtitle=Biometrika&amp;rft.atitle=Improving+efficiency+and+robustness+of+the+doubly+robust+estimator+for+a+population+mean+with+incomplete+data&amp;rft.volume=96&amp;rft.issue=3&amp;rft.pages=723-734&amp;rft.date=2009&amp;rft_id=%2F%2Fwww.ncbi.nlm.nih.gov%2Fpmc%2Farticles%2FPMC2798744&amp;rft.issn=0006-3444&amp;rft_id=info%3Apmid%2F20161511&amp;rft_id=info%3Adoi%2F10.1093%2Fbiomet%2Fasp033&amp;rft.aulast=Cao&amp;rft.aufirst=Weihua&amp;rft.au=Tsiatis%2C+Anastasios+A.&amp;rft.au=Davidian%2C+Marie&amp;rft_id=%2F%2Fwww.ncbi.nlm.nih.gov%2Fpmc%2Farticles%2FPMC2798744&amp;rfr_id=info%3Asid%2Fen.wikipedia.org%3AInverse+probability+weighting\" class=\"Z3988\"><span style=\"display:none;\">&#160;</span></span></span>\n</li>\n</ol></div></div>\n\n<!-- \nNewPP limit report\nParsed by mw2268\nCached time: 20180918002305\nCache expiry: 1900800\nDynamic content: false\nCPU time usage: 0.148 seconds\nReal time usage: 0.206 seconds\nPreprocessor visited node count: 483/1000000\nPreprocessor generated node count: 0/1500000\nPost\u2010expand include size: 12365/2097152 bytes\nTemplate argument size: 188/2097152 bytes\nHighest expansion depth: 7/40\nExpensive parser function count: 0/500\nUnstrip recursion depth: 0/20\nUnstrip post\u2010expand size: 10470/5000000 bytes\nNumber of Wikibase entities loaded: 0/400\nLua time usage: 0.047/10.000 seconds\nLua memory usage: 2.43 MB/50 MB\n-->\n<!--\nTransclusion expansion time report (%,ms,calls,template)\n100.00%  102.461      1 Template:Reflist\n100.00%  102.461      1 -total\n 76.40%   78.279      5 Template:Cite_journal\n  2.51%    2.573      1 Template:Main_other\n-->\n\n<!-- Saved in parser cache with key enwiki:pcache:idhash:33350282-0!canonical!math=5 and timestamp 20180918002305 and revision id 860050251\n -->\n</div>"},"langlinks":[],"categories":[{"sortkey":"","*":"Survey_methodology"},{"sortkey":"","*":"Epidemiology"}],"links":[{"ns":0,"exists":"","*":"CiteSeerX"},{"ns":0,"exists":"","*":"Digital object identifier"},{"ns":0,"exists":"","*":"EM algorithm"},{"ns":0,"exists":"","*":"Generalized estimating equations"},{"ns":0,"exists":"","*":"Horvitz\u2013Thompson estimator"},{"ns":0,"exists":"","*":"International Standard Serial Number"},{"ns":0,"exists":"","*":"Journal of the American Statistical Association"},{"ns":0,"exists":"","*":"Likelihood function"},{"ns":0,"exists":"","*":"Marginal structural models"},{"ns":0,"exists":"","*":"Marie Davidian"},{"ns":0,"exists":"","*":"Missing data"},{"ns":0,"exists":"","*":"Probability density function"},{"ns":0,"exists":"","*":"PubMed Central"},{"ns":0,"exists":"","*":"PubMed Identifier"},{"ns":0,"exists":"","*":"Sampling probability"},{"ns":0,"exists":"","*":"Standardized mortality ratio"}],"templates":[{"ns":10,"exists":"","*":"Template:Reflist"},{"ns":10,"exists":"","*":"Template:Cite journal"},{"ns":10,"exists":"","*":"Template:Main other"},{"ns":828,"exists":"","*":"Module:Citation/CS1"},{"ns":828,"exists":"","*":"Module:Citation/CS1/Configuration"},{"ns":828,"exists":"","*":"Module:Citation/CS1/Whitelist"},{"ns":828,"exists":"","*":"Module:Citation/CS1/Utilities"},{"ns":828,"exists":"","*":"Module:Citation/CS1/Date validation"},{"ns":828,"exists":"","*":"Module:Citation/CS1/Identifiers"},{"ns":828,"exists":"","*":"Module:Citation/CS1/COinS"},{"ns":828,"exists":"","*":"Module:Check for unknown parameters"}],"images":["Lock-green.svg"],"externallinks":["//doi.org/10.1080/01621459.1994.10476818","//www.ncbi.nlm.nih.gov/pmc/articles/PMC2768499","//doi.org/10.1093/aje/kwp055","//www.ncbi.nlm.nih.gov/pubmed/19357328","//doi.org/10.1080/01621459.1952.10483446","//www.ncbi.nlm.nih.gov/pmc/articles/PMC2652882","//citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.157.9366","//doi.org/10.1136/jech.2004.029496","//www.ncbi.nlm.nih.gov/pmc/articles/PMC2798744","//doi.org/10.1093/biomet/asp033","//www.worldcat.org/issn/0006-3444","//www.ncbi.nlm.nih.gov/pubmed/20161511"],"sections":[{"toclevel":1,"level":"2","line":"Inverse Probability Weighted Estimator (IPWE)","number":"1","index":"1","fromtitle":"Inverse_probability_weighting","byteoffset":2304,"anchor":"Inverse_Probability_Weighted_Estimator_(IPWE)"},{"toclevel":2,"level":"3","line":"Estimator Formula","number":"1.1","index":"2","fromtitle":"Inverse_probability_weighting","byteoffset":3428,"anchor":"Estimator_Formula"},{"toclevel":3,"level":"4","line":"Constructing the IPWE","number":"1.1.1","index":"3","fromtitle":"Inverse_probability_weighting","byteoffset":3585,"anchor":"Constructing_the_IPWE"},{"toclevel":3,"level":"4","line":"Assumptions","number":"1.1.2","index":"4","fromtitle":"Inverse_probability_weighting","byteoffset":4158,"anchor":"Assumptions"},{"toclevel":3,"level":"4","line":"Limitations","number":"1.1.3","index":"5","fromtitle":"Inverse_probability_weighting","byteoffset":4478,"anchor":"Limitations"},{"toclevel":1,"level":"2","line":"Augmented Inverse Probability Weighted Estimator (AIPWE)","number":"2","index":"6","fromtitle":"Inverse_probability_weighting","byteoffset":4777,"anchor":"Augmented_Inverse_Probability_Weighted_Estimator_(AIPWE)"},{"toclevel":2,"level":"3","line":"Estimator Formula","number":"2.1","index":"7","fromtitle":"Inverse_probability_weighting","byteoffset":5754,"anchor":"Estimator_Formula_2"},{"toclevel":3,"level":"4","line":"Constructing the AIPWE","number":"2.1.1","index":"8","fromtitle":"Inverse_probability_weighting","byteoffset":6008,"anchor":"Constructing_the_AIPWE"},{"toclevel":1,"level":"2","line":"References","number":"3","index":"9","fromtitle":"Inverse_probability_weighting","byteoffset":6331,"anchor":"References"}],"parsewarnings":[],"displaytitle":"Inverse probability weighting","iwlinks":[],"properties":[{"name":"wikibase_item","*":"Q17058619"}]}}