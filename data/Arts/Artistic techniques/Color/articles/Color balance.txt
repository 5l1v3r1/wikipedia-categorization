In photography and image processing, color balance is the global adjustment of the intensities of the colors (typically red, green, and blue primary colors).  An important goal of this adjustment is to render specific colors – particularly neutral colors – correctly. Hence, the general method is sometimes called gray balance, neutral balance, or white balance.  Color balance changes the overall mixture of colors in an image and is used for color correction. Generalized versions of color balance are used to correct colors other than neutrals or to deliberately change them for effect. Image data acquired by sensors – either film or electronic image sensors – must be transformed from the acquired values to new values that are appropriate for color reproduction or display.  Several aspects of the acquisition and display process make such color correction essential – including the fact that the acquisition sensors do not match the sensors in the human eye, that the properties of the display medium must be accounted for, and that the ambient viewing conditions of the acquisition differ from the display viewing conditions. The color balance operations in popular image editing applications usually operate directly on the red, green, and blue channel pixel values,   without respect to any color sensing or reproduction model.  In film photography, color balance is typically achieved by using color correction filters over the lights or on the camera lens.  Sometimes the adjustment to keep neutrals neutral is called white balance, and the phrase color balance refers to the adjustment that in addition makes other colors in a displayed image appear to have the same general appearance as the colors in an original scene.  It is particularly important that neutral (gray, neutral, white) colors in a scene appear neutral in the reproduction.   Most digital cameras have means to select color correction based on the type of scene lighting, using either manual lighting selection, automatic white balance, or custom white balance.  The algorithms for these processes perform generalized chromatic adaptation. Many methods exist for color balancing.  Setting a button on a camera is a way for the user to indicate to the processor the nature of the scene lighting. Another option on some cameras is a button which one may press when the camera is pointed at a gray card or other neutral colored object. This captures an image of the ambient light, which enables a digital camera to set the correct color balance for that light. There is a large literature on how one might estimate the ambient lighting from the camera data and then use this information to transform the image data. A variety of algorithms have been proposed, and the quality of these has been debated. A few examples and examination of the references therein will lead the reader to many others. Examples are Retinex, an artificial neural network  or a Bayesian method.  Color balancing an image affects not only the neutrals, but other colors as well. An image that is not color balanced is said to have a color cast, as everything in the image appears to have been shifted towards one color. [page needed] Color balancing may be thought in terms of removing this color cast. Color balance is also related to color constancy. Algorithms and techniques used to attain color constancy are frequently used for color balancing, as well. Color constancy is, in turn, related to chromatic adaptation. Conceptually, color balancing consists of two steps: first, determining the illuminant under which an image was captured; and second, scaling the components (e.g., R, G, and B) of the image or otherwise transforming the components so they conform to the viewing illuminant. Viggiano found that white balancing in the camera's native RGB color model tended to produce less color inconstancy (i.e., less distortion of the colors) than in monitor RGB for over 4000 hypothetical sets of camera sensitivities.  This difference typically amounted to a factor of more than two in favor of camera RGB. This means that it is advantageous to get color balance right at the time an image is captured, rather than edit later on a monitor. If one must color balance later, balancing the raw image data will tend to produce less distortion of chromatic colors than balancing in monitor RGB. Color balancing is sometimes performed on a three-component image (e.g., RGB) using a 3x3 matrix. This type of transformation is appropriate if the image was captured using the wrong white balance setting on a digital camera, or through a color filter. In principle, one wants to scale all relative luminances in an image so that objects which are believed to be neutral appear so. If, say, a surface with                         R         =         240                 {\displaystyle R=240}     was believed to be a white object, and if 255 is the count which corresponds to white, one could multiply all red values by 255/240. Doing analogously for green and blue would result, at least in theory, in a color balanced image. In this type of transformation the 3x3 matrix is a diagonal matrix. where                         R                 {\displaystyle R}    ,                         G                 {\displaystyle G}    , and                         B                 {\displaystyle B}     are the color balanced red, green, and blue components of a pixel in the image;                                    R           ′                          {\displaystyle R'}    ,                                    G           ′                          {\displaystyle G'}    , and                                    B           ′                          {\displaystyle B'}     are the red, green, and blue components of the image before color balancing, and                                    R                        w                      ′                          {\displaystyle R'_{w}}    ,                                    G                        w                      ′                          {\displaystyle G'_{w}}    , and                                    B                        w                      ′                          {\displaystyle B'_{w}}     are the red, green, and blue components of a pixel which is believed to be a white surface in the image before color balancing. This is a simple scaling of the red, green, and blue channels, and is why color balance tools in Photoshop and the GIMP have a white eyedropper tool.  It has been demonstrated that performing the white balancing in the phosphor set assumed by sRGB tends to produce large errors in chromatic colors, even though it can render the neutral surfaces perfectly neutral.  If the image may be transformed into CIE XYZ tristimulus values, the color balancing may be performed there.  This has been termed a “wrong von Kries” transformation.   Although it has been demonstrated to offer usually poorer results than balancing in monitor RGB, it is mentioned here as a bridge to other things. Mathematically, one computes: where                         X                 {\displaystyle X}    ,                         Y                 {\displaystyle Y}    , and                         Z                 {\displaystyle Z}     are the color-balanced tristimulus values;                                    X                        w                                     {\displaystyle X_{w}}    ,                                    Y                        w                                     {\displaystyle Y_{w}}    , and                                    Z                        w                                     {\displaystyle Z_{w}}     are the tristimulus values of the viewing illuminant (the white point to which the image is being transformed to conform to);                                    X                        w                      ′                          {\displaystyle X'_{w}}    ,                                    Y                        w                      ′                          {\displaystyle Y'_{w}}    , and                                    Z                        w                      ′                          {\displaystyle Z'_{w}}     are the tristimulus values of an object believed to be white in the un-color-balanced image, and                                    X           ′                          {\displaystyle X'}    ,                                    Y           ′                          {\displaystyle Y'}    , and                                    Z           ′                          {\displaystyle Z'}     are the tristimulus values of a pixel in the un-color-balanced image. If the tristimulus values of the monitor primaries are in a matrix                                    P                          {\displaystyle \mathbf {P} }     so that: where                                    L                        R                                     {\displaystyle L_{R}}    ,                                    L                        G                                     {\displaystyle L_{G}}    , and                                    L                        B                                     {\displaystyle L_{B}}     are the un-gamma corrected monitor RGB, one may use: Johannes von Kries, whose theory of rods and three color-sensitive cone types in the retina has survived as the dominant explanation of color sensation for over 100 years, motivated the method of converting color to the LMS color space, representing the effective stimuli for the Long-, Medium-, and Short-wavelength cone types that are modeled as adapting independently.  A 3x3 matrix converts RGB or XYZ to LMS, and then the three LMS primary values are scaled to balance the neutral; the color can then be converted back to the desired final color space:  where                         L                 {\displaystyle L}    ,                         M                 {\displaystyle M}    , and                         S                 {\displaystyle S}     are the color-balanced LMS cone tristimulus values;                                    L                        w                      ′                          {\displaystyle L'_{w}}    ,                                    M                        w                      ′                          {\displaystyle M'_{w}}    , and                                    S                        w                      ′                          {\displaystyle S'_{w}}     are the tristimulus values of an object believed to be white in the un-color-balanced image, and                                    L           ′                          {\displaystyle L'}    ,                                    M           ′                          {\displaystyle M'}    , and                                    S           ′                          {\displaystyle S'}     are the tristimulus values of a pixel in the un-color-balanced image. Matrices to convert to LMS space were not specified by von Kries, but can be derived from CIE color matching functions and LMS color matching functions when the latter are specified; matrices can also be found in reference books.  By Viggiano's measure, and using his model of gaussian camera spectral sensitivities, most camera RGB spaces performed better than either monitor RGB or XYZ.   If the camera's raw RGB values are known, one may use the 3x3 diagonal matrix: and then convert to a working RGB space such as sRGB or Adobe RGB after balancing. Comparisons of images balanced by diagonal transforms in a number of different RGB spaces have identified several such spaces that work better than others, and better than camera or monitor spaces, for chromatic adaptation, as measured by several color appearance models; the systems that performed statistically as well as the best on the majority of the image test sets used were the "Sharp", "Bradford", "CMCCAT", and "ROMM" spaces.  The best color matrix for adapting to a change in illuminant is not necessarily a diagonal matrix in a fixed color space.  It has long been known that if the space of illuminants can be described as a linear model with N basis terms, the proper color transformation will be the weighted sum of N fixed linear transformations, not necessarily consistently diagonalizable.  