In applied statistics, optimal estimation is a regularized matrix inverse method based on Bayes' theorem. It is used very commonly in the geosciences, particularly for atmospheric sounding. A matrix inverse problem looks like this: The essential concept is to transform the matrix, A, into a conditional probability and the variables,                                                                x               →                                                  {\displaystyle {\vec {x}}}     and                                                                y               →                                                  {\displaystyle {\vec {y}}}     into probability distributions by assuming Gaussian statistics and using empirically-determined covariance matrices. Typically, one expects the statistics of most measurements to be Gaussian.  So for example for                         P         (                                                y               →                                                     |                                                         x               →                                          )                 {\displaystyle P({\vec {y}}|{\vec {x}})}    , we can write: where m and n are the numbers of elements in                                                                x               →                                                  {\displaystyle {\vec {x}}}     and                                                                y               →                                                  {\displaystyle {\vec {y}}}     respectively                                    A                          {\displaystyle {\boldsymbol {A}}}     is the matrix to be solved (the linear or linearised forward model) and                                                 S                            y                                                  {\displaystyle {\boldsymbol {S_{y}}}}     is the covariance matrix of the vector                                                                y               →                                                  {\displaystyle {\vec {y}}}    .  This can be similarly done for                                                                x               →                                                  {\displaystyle {\vec {x}}}    : Here                         P         (                                                x               →                                          )                 {\displaystyle P({\vec {x}})}     is taken to be the so-called "a-priori" distribution:                                                                                  x                                    a                                               ^                                                  {\displaystyle {\widehat {x_{a}}}}     denotes the a-priori values for                                                                x               →                                                  {\displaystyle {\vec {x}}}     while                                                 S                                             x                                    a                                                                                  {\displaystyle {\boldsymbol {S_{x_{a}}}}}     is its covariance matrix. The nice thing about the Gaussian distributions is that only two parameters are needed to describe them and so the whole problem can be converted once again to matrices.  Assuming that                         P         (                                                x               →                                                     |                                                         y               →                                          )                 {\displaystyle P({\vec {x}}|{\vec {y}})}     takes the following form:                         P         (                                                y               →                                          )                 {\displaystyle P({\vec {y}})}     may be neglected since, for a given value of                                                                x               →                                                  {\displaystyle {\vec {x}}}    , it is simply a constant scaling term.  Now it is possible to solve for both the expectation value of                                                                x               →                                                  {\displaystyle {\vec {x}}}    ,                                                                x               ^                                                  {\displaystyle {\widehat {x}}}    , and for its covariance matrix by equating                         P         (                                                x               →                                                     |                                                         y               →                                          )                 {\displaystyle P({\vec {x}}|{\vec {y}})}     and                         P         (                                                y               →                                                     |                                                         x               →                                          )         P         (                                                x               →                                          )                 {\displaystyle P({\vec {y}}|{\vec {x}})P({\vec {x}})}    .  This produces the following equations: Because we are using Gaussians, the expected value is equivalent to the maximum likely value, and so this is also a form of maximum likelihood estimation. Typically with optimal estimation, in addition to the vector of retrieved quantities, one extra matrix is returned along with the covariance matrix.  This is sometimes called the resolution matrix or the averaging kernel and is calculated as follows: This tells us, for a given element of the retrieved vector, how much of the other elements of the vector are mixed in.  In the case of a retrieval of profile information, it typical indicates the altitude resolution for a given altitude.  For instance if the resolution vectors for all the altitudes contain non-zero elements (to a numerical tolerance) in their four nearest neighbours, then the altitude resolution is only one fourth that of the actual grid size. 