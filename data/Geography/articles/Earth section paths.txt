Earth section paths are paths on the earth defined by the intersection of a reference ellipsoid and a plane. Common examples of earth sections include the great ellipse and normal sections. This page provides a unifying approach to all earth sections and their associated geodetic problems. The indirect problem for earth sections is: given two points,                                    P                        1                                     {\displaystyle P_{1}}     and                                    P                        2                                     {\displaystyle P_{2}}     on the surface of the reference ellipsoid, find the length,                                    s                        12                                     {\displaystyle s_{12}}    , of the short arc of a spheroid section from                                    P                        1                                     {\displaystyle P_{1}}     to                                    P                        2                                     {\displaystyle P_{2}}     and also find the departure and arrival (true north referenced) azimuths of that curve,                                    α                        1                                     {\displaystyle \alpha _{1}}     and                                    α                        2                                     {\displaystyle \alpha _{2}}    . Let                                    P                        k                                     {\displaystyle P_{k}}     have geodetic latitude                                     ϕ                        k                                     {\displaystyle \phi _{k}}     and longitude                                    λ                        k                                     {\displaystyle \lambda _{k}}     (k=1,2). This problem is best solved using analytic geometry in ECEF coordinates. Let                                    R                        1                             =         E         C         E         F         (                    P                        1                             )                 {\displaystyle R_{1}=ECEF(P_{1})}     and                                    R                        2                             =         E         C         E         F         (                    P                        2                             )                 {\displaystyle R_{2}=ECEF(P_{2})}     be the ECEF coordinates of the two points, computed using the geodetic to ECEF transformations discussed here. To define the section plane select any third point                                    R                        0                                     {\displaystyle R_{0}}     not on the line from                                    R                        1                                     {\displaystyle R_{1}}     to                                    R                        2                                     {\displaystyle R_{2}}    . Choosing                                    R                        0                                     {\displaystyle R_{0}}     to be on the surface normal at                                    P                        1                                     {\displaystyle P_{1}}     will define the normal section at                                    P                        1                                     {\displaystyle P_{1}}    . If                                    R                        0                                     {\displaystyle R_{0}}     is the origin then the earth section is the great ellipse. (The origin would be co-linear with 2 antipodal points so a different point must be used in that case). Since there are infinitely many choices for                                    R                        0                                     {\displaystyle R_{0}}    , the above problem is really a class of problems (one for each plane). Let                                    R                        0                                     {\displaystyle R_{0}}     be given. To put the equation of the plane into the standard form,                         l         x         +         m         y         +         n         z         =         d                 {\displaystyle lx+my+nz=d}    , where                                              l                        2                             +                    m                        2                             +                    n                        2                             =         1                 {\displaystyle \ l^{2}+m^{2}+n^{2}=1}    , requires the components of a unit vector,                                                                N               ^                                          =         (         l         ,         m         ,         n         )                 {\displaystyle {\hat {N}}=(l,m,n)}    , normal to the section plane. These components may be computed as follows: The vector from                                    R                        0                                     {\displaystyle R_{0}}     to                                    R                        1                                     {\displaystyle R_{1}}     has components                                    V                        0                             =                    R                        1                             −                    R                        0                                     {\displaystyle V_{0}=R_{1}-R_{0}}    , and the vector from                                    R                        1                                     {\displaystyle R_{1}}     to                                    R                        2                                     {\displaystyle R_{2}}     has components                                    V                        1                             =                    R                        2                             −                    R                        1                                     {\displaystyle V_{1}=R_{2}-R_{1}}    . Therefore,                                                                N               ^                                                  {\displaystyle {\hat {N}}}     =                         u         n         i         t         (                    V                        0                                     {\displaystyle unit(V_{0}}    ×                                   V                        1                                     {\displaystyle V_{1}}    ), where                         u         n         i         t         (         V         )                 {\displaystyle unit(V)}     is the unit vector in the direction of                         V                 {\displaystyle V}    . The orientation convention used here is that                                                                N               ^                                                  {\displaystyle {\hat {N}}}     points to the left of the path. If this is not the case then redefine                                    V                        0                                     {\displaystyle V_{0}}     = -                                   V                        0                                     {\displaystyle V_{0}}    . Finally, the parameter d for the plane may be computed using the dot product of                                                                N               ^                                                  {\displaystyle {\hat {N}}}     with a vector from the origin to any point on the plane, such as                                    R                        1                                     {\displaystyle R_{1}}    , i.e. d =                                                                N               ^                                          ⋅                                 R                            1                                                  {\displaystyle {\hat {N}}\cdot {R_{1}}}    . The equation of the plane (in vector form) is thus                                                                N               ^                                                  {\displaystyle {\hat {N}}}     ⋅                         R                 {\displaystyle R}     = d, where                         R                 {\displaystyle R}     is the position vector of (x, y, z). A unit vector pointing up at any point on the ellipsoid is:                                                                u               ^                                                  {\displaystyle \mathbf {\hat {u}} }    =                        (         cos         ⁡         ϕ         cos         ⁡         λ         ,         cos         ⁡         ϕ         sin         ⁡         λ         ,         sin         ⁡         ϕ         )                 {\displaystyle (\cos \phi \cos \lambda ,\cos \phi \sin \lambda ,\sin \phi )}    , a unit vector pointing north is                                                                n               ^                                                  {\displaystyle \mathbf {\hat {n}} }    =                        (         −         sin         ⁡         ϕ         cos         ⁡         λ         ,         −         sin         ⁡         ϕ         sin         ⁡         λ         ,         cos         ⁡         ϕ         )                 {\displaystyle (-\sin \phi \cos \lambda ,-\sin \phi \sin \lambda ,\cos \phi )}    , and east is                                                                e               ^                                                  {\displaystyle \mathbf {\hat {e}} }    =                        (         −         sin         ⁡         λ         ,         cos         ⁡         λ         ,         0         )                 {\displaystyle (-\sin \lambda ,\cos \lambda ,0)}    . A vector tangent to the path is:                                    t                  =                                                N               ^                                          ×                                                u               ^                                                  {\displaystyle \mathbf {t} ={\hat {N}}\times \mathbf {\hat {u}} }     so the east component of                                    t                          {\displaystyle \mathbf {t} }     is                                    t                  ⋅                                                e               ^                                                  {\displaystyle \mathbf {t} \cdot \mathbf {\hat {e}} }    , and the north component is                                    t                  ⋅                                                n               ^                                                  {\displaystyle \mathbf {t} \cdot \mathbf {\hat {n}} }    . Therefore, the azimuth may be obtained from a two-argument arctangent function,                         α                 {\displaystyle \alpha }    =                        atan2         ⁡         (                    t                  ⋅                                                e               ^                                          ,                    t                  ⋅                                                n               ^                                          )                 {\displaystyle \operatorname {atan2} (\mathbf {t} \cdot \mathbf {\hat {e}} ,\mathbf {t} \cdot \mathbf {\hat {n}} )}    . Use this method at both                                    P                        1                                     {\displaystyle P_{1}}     and                                    P                        2                                     {\displaystyle P_{2}}     to get                                    α                        1                                     {\displaystyle \alpha _{1}}     and                                    α                        2                                     {\displaystyle \alpha _{2}}    . The (non-trivial) intersection of a plane and ellipsoid is an ellipse. Therefore, the arc length,                                    s                        12                                     {\displaystyle s_{12}}    , on the section path from                                    P                        1                                     {\displaystyle P_{1}}     to                                    P                        2                                     {\displaystyle P_{2}}     is an elliptic integral that may be computed to any desired accuracy using a truncated series. Before this can be done the ellipse must be defined and the limits of integration computed. Let the ellipsoid given by                                                                x                                2                                                        a                                2                                                         +                                                y                                2                                                        a                                2                                                         +                                                z                                2                                                        b                                2                                                         =         1                 {\displaystyle {\frac {x^{2}}{a^{2}}}+{\frac {y^{2}}{a^{2}}}+{\frac {z^{2}}{b^{2}}}=1}    , and let                         p         =                                                l                                2                                         +                            m                                2                                                                 {\displaystyle p={\sqrt {l^{2}+m^{2}}}}    . If p=0 then the section is a horizontal circle of radius                         a                                 1             −                                                                d                                        2                                                                        b                                        2                                                                                                     {\displaystyle a{\sqrt {1-{\frac {d^{2}}{b^{2}}}}}}    , which has no solution if                                    |                  d                    |                  >         b                 {\displaystyle |d|>b}    . If p>0 then Gilbertson  showed that the ECEF coordinates of the center of the ellipse is                                                 R                            c                                          =                                 d             C                             (         l                    a                        2                             ,         m                    a                        2                             ,         n                    b                        2                             )                 {\displaystyle {R_{c}}={\frac {d}{C}}(la^{2},ma^{2},nb^{2})}    , where                         C         =                    a                        2                                        p                        2                             +                    b                        2                                        n                        2                                     {\displaystyle C=a^{2}p^{2}+b^{2}n^{2}}    , the semi-major axis is                                    a                        ∗                             =         a                                 1             −                                                                d                                        2                                                     C                                                                 {\displaystyle a^{*}=a{\sqrt {1-{\frac {d^{2}}{C}}}}}    , in the direction                                                                                 i                                    ∗                                               ^                                          =         (                                 m             p                             ,                                                −               l                          p                             ,         0         )                 {\displaystyle \mathbf {\hat {i^{*}}} =({\frac {m}{p}},{\frac {-l}{p}},0)}    , and the semi-minor axis is                                    b                        ∗                             =                                 b                            C                                                     a                        ∗                                     {\displaystyle b^{*}={\frac {b}{\sqrt {C}}}a^{*}}    ,  in the direction                                                                                 j                                    ∗                                               ^                                          =         (                                                l               n                          p                             ,                                                m               n                          p                             ,         −         p         )                 {\displaystyle \mathbf {\hat {j^{*}}} =({\frac {ln}{p}},{\frac {mn}{p}},-p)}    , which has no solution if                                    |                  d                    |                  >                                 C                                     {\displaystyle |d|>{\sqrt {C}}}    . The polar form relative to center for the equation of an ellipse is                         R         (         θ         )         =                                                b                                ∗                                                        1               −                                e                                    2                                                                cos                                    2                                               ⁡               θ                                                  {\displaystyle R(\theta )={\frac {b^{*}}{\sqrt {1-e^{2}\cos ^{2}\theta }}}}    , where                                    e                        2                             =         1         −                                                (                                b                                    ∗                                                                )                                    2                                                                         (                                a                                    ∗                                                                )                                    2                                                                                  {\displaystyle e^{2}=1-{\frac {(b^{*})^{2}}{(a^{*})^{2}}}}    , relates to the ellipse eccentricity,  not the spheroid eccentricity (see ellipse). Let P be a point on the ellipse and                         R         =         E         C         E         F         (         P         )                 {\displaystyle R=ECEF(P)}    , then the vector from                                                 R                            c                                                  {\displaystyle {R_{c}}}     to                         R                 {\displaystyle R}     has components                         R         −                    R                        c                                     {\displaystyle R-R_{c}}    . Using an argument similar to the one for azimuth above, let                                                                w               ^                                          =         u         n         i         t         (         R         −                    R                        c                             )                 {\displaystyle \mathbf {\hat {w}} =unit(R-R_{c})}    , then                         cos         ⁡         θ         =                                                w               ^                                          ⋅                                                                 i                                    ∗                                               ^                                                  {\displaystyle \cos \theta =\mathbf {\hat {w}} \cdot \mathbf {\hat {i^{*}}} }    , and                         sin         ⁡         θ         =                                                w               ^                                          ⋅                                                                 j                                    ∗                                               ^                                                  {\displaystyle \sin \theta =\mathbf {\hat {w}} \cdot \mathbf {\hat {j^{*}}} }    , and                         θ         =         atan2         ⁡         (         sin         ⁡         θ         ,         cos         ⁡         θ         )                 {\displaystyle \theta =\operatorname {atan2} (\sin \theta ,\cos \theta )}    . In this way we obtain the central angles                                    θ                        1                                     {\displaystyle \theta _{1}}     and                                    θ                        2                                     {\displaystyle \theta _{2}}     corresponding to                                    P                        1                                     {\displaystyle P_{1}}     and                                    P                        2                                     {\displaystyle P_{2}}     respectively. Care must be taken to ensure that 0 ≤                                    θ                        1                                     {\displaystyle \theta _{1}}     ≤                                    θ                        2                                     {\displaystyle \theta _{2}}     ≤                                    θ                        1                             +         π                 {\displaystyle \theta _{1}+\pi }    . Then the arc length along the ellipse is given by                                    s                        12                                     {\displaystyle s_{12}}     =                                   ∫                                       θ                                1                                                                              θ                                2                                                                                                R                                2                                         +             (                            R                                                                      ′                                                                         )                                2                                                         d         θ         .                 {\displaystyle \int _{\theta _{1}}^{\theta _{2}}{\sqrt {R^{2}+(R^{'})^{2}}}d\theta .}     Substituting                         r         (         θ         )                 {\displaystyle r(\theta )}     above into this formula, performing the indicated operations, using one more term than Gilbertson's expression and regrouping, results in                                     s                        12                             =         A         r         c         L         e         n         g         t         h         (                    θ                        1                             ,                    θ                        2                             )         =                    b                        ∗                             (                                 c                            0                                          Δ         θ         +                                 c                            1                                          Δ         s         2         +                                 c                            2                                          Δ         s         4         +                                 c                            3                                          Δ         s         6         )                 {\displaystyle s_{12}=ArcLength(\theta _{1},\theta _{2})=b^{*}({c_{0}}\Delta \theta +{c_{1}}\Delta s2+{c_{2}}\Delta s4+{c_{3}}\Delta s6)}    , where Alternatively, expansions for the Meridian arc may be used here by replacing the spheroid eccentricity with the section ellipse eccentricity. The direct problem is given                                                 P                            1                                                  {\displaystyle {P_{1}}}    , the distance,                         δ                 {\displaystyle \delta }    , and departure azimuth,                                    α                        1                                     {\displaystyle \alpha _{1}}    , find                                                 P                            2                                                  {\displaystyle {P_{2}}}     and the arrival azimuth,                                    α                        2                                     {\displaystyle \alpha _{2}}    . Construct the tangent vector at                                                 P                            1                                                  {\displaystyle {P_{1}}}    ,                                                                                 t                                    1                                               ^                                          =                                                                 n                                    1                                               ^                                          cos         ⁡                                 α                            1                                          +                                                                 e                                    1                                               ^                                          sin         ⁡                                 α                            1                                                  {\displaystyle \mathbf {\hat {t_{1}}} =\mathbf {\hat {n_{1}}} \cos {\alpha _{1}}+\mathbf {\hat {e_{1}}} \sin {\alpha _{1}}}    , where                                                                                 n                                    1                                               ^                                                  {\displaystyle \mathbf {\hat {n_{1}}} }     and                                                                                 e                                    1                                               ^                                                  {\displaystyle \mathbf {\hat {e_{1}}} }     are unit vectors pointing north and east (respectively) at                                                 P                            1                                                  {\displaystyle {P_{1}}}    . Pick a vector,                                     V                        0                                     {\displaystyle V_{0}}    , to define the section plane, paying attention to orientation. Observe that                                    V                        0                                     {\displaystyle V_{0}}     must not be in span{                                                                                n                                    1                                               ^                                          ,                                                                 e                                    1                                               ^                                                  {\displaystyle \mathbf {\hat {n_{1}}} ,\mathbf {\hat {e_{1}}} }    } (otherwise the plane would be tangent to the earth at                                                 P                            1                                                  {\displaystyle {P_{1}}}    , so no path would result). The normal vector                                                                N               ^                                                  {\displaystyle {\hat {N}}}     =                         u         n         i         t         (                    V                        0                                     {\displaystyle unit(V_{0}}    ×                                                                                t                                    1                                               ^                                                  {\displaystyle \mathbf {\hat {t_{1}}} }    ),  together with                                                 P                            1                                                  {\displaystyle {P_{1}}}     defines the plane. This is a 2-d problem in span{                                                                                i                                    ∗                                               ^                                          ,                                                                 j                                    ∗                                               ^                                                  {\displaystyle \mathbf {\hat {i^{*}}} ,\mathbf {\hat {j^{*}}} }    },  which will be solved with the help of the arc length formula above. The basic approach is to use Newton-Raphson iteration to arrive at                                                 P                            2                                                  {\displaystyle {P_{2}}}    . The basis of the estimate is that the position vector of any point on the section ellipse may be expressed in terms of the position vector of the center and the central angle as                          V         =                                 V                            c                                          +                    r           (           θ           )                  (                                                                 i                                    ∗                                               ^                                          cos         ⁡         θ         +                                                                 j                                    ∗                                               ^                                          sin         ⁡         θ         )                 {\displaystyle V={V_{c}}+{r(\theta )}(\mathbf {\hat {i^{*}}} \cos \theta +\mathbf {\hat {j^{*}}} \sin \theta )}    . To get an initial estimate of                                                 θ                            2                                                  {\displaystyle {\theta _{2}}}    , let                                                 V                            1                                          =                                 R                            1                                          −         R                                                             c                                                  {\displaystyle {V_{1}}={R_{1}}-R{_{c}}}    ,                                                 θ                            1                                                  {\displaystyle {\theta _{1}}}    =Central_Angle                        (                                 V                            1                                          )                 {\displaystyle ({V_{1}})}     (see the arc length section above),                                                 r                            1                                          =         r         (                                 θ                            1                                          )                 {\displaystyle {r_{1}}=r({\theta _{1}})}    ,                         Δ         θ         =                                 δ                            r                                1                                                                 {\displaystyle \Delta \theta ={\frac {\delta }{r_{1}}}}    . Now initialize                                    θ                        2                                     {\displaystyle \theta _{2}}     =                                    θ                        1                             +         Δ         θ                 {\displaystyle \theta _{1}+\Delta \theta }    , and iterate the following steps: exit when                         a         b         s         (         Δ         θ         )         <                    10                        −             12                                     {\displaystyle abs(\Delta \theta )<10^{-12}}     No more than three iterations are usually necessary, although nearly antipodal cases can be problematic. Finally, let                                                 V                            2                                          =                                 V                            c                                          +                    r           (                        θ                            2                                   )                  (                                                                 i                                    ∗                                               ^                                          cos         ⁡                    θ                        2                             +                                                                 j                                    ∗                                               ^                                          sin         ⁡                    θ                        2                             )                 {\displaystyle {V_{2}}={V_{c}}+{r(\theta _{2})}(\mathbf {\hat {i^{*}}} \cos \theta _{2}+\mathbf {\hat {j^{*}}} \sin \theta _{2})}    , and                                                 P                            2                                                  {\displaystyle {P_{2}}}     = ECEF_to_Geo                        (                                 V                            2                                          )                 {\displaystyle ({V_{2}})}     using Bowring’s 1985 algorithm,  or the algorithm here. Alternatively, inversion of the arc length series may be used to avoid iterations. Azimuth may be obtained by the same method as the indirect problem:                                                 α                            2                                                  {\displaystyle {\alpha _{2}}}    =                        atan2         ⁡         (                                 t                            2                                          ⋅                                                                 e                                    2                                               ^                                          ,                                 t                            2                                          ⋅                                                                 n                                    2                                               ^                                          )                 {\displaystyle \operatorname {atan2} (\mathbf {t_{2}} \cdot \mathbf {\hat {e_{2}}} ,\mathbf {t_{2}} \cdot \mathbf {\hat {n_{2}}} )}    , where the subscript 2 indicates evaluation of the associated quantity at                                    P                        2                                     {\displaystyle P_{2}}    . Let                                    R                        0                                     {\displaystyle R_{0}}     be the origin, so that                                                 V                            0                                                  {\displaystyle {V_{0}}}     = the position vector of                                    R                        1                                     {\displaystyle R_{1}}    . The above approach provides an alternative to that of others, such as Bowring.  The normal section at                                    P                        1                                     {\displaystyle P_{1}}     is determined by letting                                                 V                            0                                                  {\displaystyle {V_{0}}}     =                                                                                  u                                    1                                               ^                                                  {\displaystyle \mathbf {\hat {u_{1}}} }     (the surface normal at                                    P                        1                                     {\displaystyle P_{1}}    ). The above approach provides an alternative to that of others, such as Bowring.  The mean normal section from                                    P                        1                                     {\displaystyle P_{1}}     to                                    P                        2                                     {\displaystyle P_{2}}     is determined by letting                                                 V                            0                                                  {\displaystyle {V_{0}}}     =                          0.5         (                                                                 u                                    1                                               ^                                          +                                                                 u                                    2                                               ^                                          )                 {\displaystyle 0.5(\mathbf {\hat {u_{1}}} +\mathbf {\hat {u_{2}}} )}    . This is a good approximation to the geodesic from                                    P                        1                                     {\displaystyle P_{1}}     to                                    P                        2                                     {\displaystyle P_{2}}     for aviation or sailing. A class of sections may be imagined by rotating                                                                                 u                                    1                                               ^                                                  {\displaystyle \mathbf {\hat {u_{1}}} }     about the chord connecting                                    P                        1                                     {\displaystyle P_{1}}     and                                    P                        2                             .                 {\displaystyle P_{2}.}     All of these may be solved with the single approach above. Let two section planes be given:                                                                                 N                                    1                                               ^                                                  {\displaystyle {\hat {N_{1}}}}    ⋅                        R                 {\displaystyle R}     =                                    d                        1                                     {\displaystyle d_{1}}    , and                                                                                 N                                    2                                               ^                                                  {\displaystyle {\hat {N_{2}}}}    ⋅                        R                 {\displaystyle R}     =                                    d                        2                                     {\displaystyle d_{2}}    . Assuming that the two planes are not parallel, the line of intersection is on both planes. Hence orthogonal to both normals, i.e. in the direction of                                                                                 N                                    3                                               ^                                          =                                                                 N                                    1                                               ^                                          ×                                                                 N                                    2                                               ^                                                  {\displaystyle {\hat {N_{3}}}={\hat {N_{1}}}\times {\hat {N_{2}}}}    . Since                                                                                 N                                    1                                               ^                                                  {\displaystyle {\hat {N_{1}}}}     and                                                                                 N                                    2                                               ^                                                  {\displaystyle {\hat {N_{2}}}}     are not colinear                                                                                 N                                    1                                               ^                                                  {\displaystyle {\hat {N_{1}}}}    ,                                                                                 N                                    2                                               ^                                                  {\displaystyle {\hat {N_{2}}}}    ,                                                                                 N                                    3                                               ^                                                  {\displaystyle {\hat {N_{3}}}}     is a basis for                                    R                        3                                     {\displaystyle R^{3}}    . Therefore, there exist constants                                    C                        1                                     {\displaystyle C_{1}}     and                                    C                        2                                     {\displaystyle C_{2}}     such that the line of intersection of the 2 planes is given by                         R                 {\displaystyle R}     =                                    C                        1                                                                                     N                                    1                                               ^                                                  {\displaystyle C_{1}{\hat {N_{1}}}}     +                                    C                        2                                                                                     N                                    2                                               ^                                                  {\displaystyle C_{2}{\hat {N_{2}}}}     + t                                                                                N                                    3                                               ^                                                  {\displaystyle {\hat {N_{3}}}}    , where t is an independent parameter. Since this line is on both section planes, it satisfies both:                                     C                        1                                     {\displaystyle C_{1}}     +                                    C                        2                                     {\displaystyle C_{2}}    (                                                                                N                                    1                                               ^                                                  {\displaystyle {\hat {N_{1}}}}    ·                                                                                N                                    2                                               ^                                                  {\displaystyle {\hat {N_{2}}}}    ) =                                    d                        1                                     {\displaystyle d_{1}}    , and                                     C                        1                                     {\displaystyle C_{1}}    (                                                                                N                                    1                                               ^                                                  {\displaystyle {\hat {N_{1}}}}    ·                                                                                N                                    2                                               ^                                                  {\displaystyle {\hat {N_{2}}}}    ) +                                    C                        2                                     {\displaystyle C_{2}}     =                                    d                        2                                     {\displaystyle d_{2}}    . Solving these equations for                                                 C                            1                                                  {\displaystyle {C_{1}}}     and                                                 C                            2                                                  {\displaystyle {C_{2}}}     gives                                     C                        1                                     {\displaystyle C_{1}}     [1 - (                                                                                N                                    1                                               ^                                                                                                  N                                    2                                               ^                                                     )                        2                                     {\displaystyle {\hat {N_{1}}}{\hat {N_{2}}})^{2}}     ] =                                    d                        1                                     {\displaystyle d_{1}}     -                                    d                        2                                     {\displaystyle d_{2}}    (                                                                                N                                    1                                               ^                                                  {\displaystyle {\hat {N_{1}}}}    ·                                                                                N                                    2                                               ^                                                  {\displaystyle {\hat {N_{2}}}}    ), and                                     C                        2                                     {\displaystyle C_{2}}     [1 - (                                                                                N                                    1                                               ^                                                                                                  N                                    2                                               ^                                                     )                        2                                     {\displaystyle {\hat {N_{1}}}{\hat {N_{2}}})^{2}}     ] =                                    d                        2                                     {\displaystyle d_{2}}     -                                    d                        1                                     {\displaystyle d_{1}}    (                                                                                N                                    1                                               ^                                                  {\displaystyle {\hat {N_{1}}}}    ·                                                                                N                                    2                                               ^                                                  {\displaystyle {\hat {N_{2}}}}    ). Define the “dihedral angle”,                         α                 {\displaystyle \alpha }    , by                         cos         ⁡         α                 {\displaystyle \cos \alpha }     =                                                                                 N                                    1                                               ^                                                  {\displaystyle {\hat {N_{1}}}}    ·                                                                                N                                    2                                               ^                                                  {\displaystyle {\hat {N_{2}}}}    . Then                                    C                        1                                     {\displaystyle C_{1}}     =                                                                (                                d                                    1                                               −                                d                                    2                                               cos               ⁡               α               )                                                          sin                                    2                                               ⁡               α                                                  {\displaystyle {\frac {(d_{1}-d_{2}\cos \alpha )}{\sin ^{2}\alpha }}}     ,  and                                    C                        2                                     {\displaystyle C_{2}}     =                                                                (                                d                                    2                                               −                                d                                    1                                               cos               ⁡               α               )                                                          sin                                    2                                               ⁡               α                                                  {\displaystyle {\frac {(d_{2}-d_{1}\cos \alpha )}{\sin ^{2}\alpha }}}    . On the intersection line we have                         R                 {\displaystyle R}     =                                    R                        0                                     {\displaystyle R_{0}}     + t                                                                                N                                    3                                               ^                                                  {\displaystyle {\hat {N_{3}}}}    ,  where                                    R                        0                                     {\displaystyle R_{0}}     =                                    C                        1                                                                                     N                                    1                                               ^                                                  {\displaystyle C_{1}{\hat {N_{1}}}}     +                                    C                        2                                                                                     N                                    2                                               ^                                                  {\displaystyle C_{2}{\hat {N_{2}}}}    . Hence:                         x                 {\displaystyle x}     =                                    x                        0                                     {\displaystyle x_{0}}     + t                                   l                        3                                     {\displaystyle l_{3}}    ,                         y                 {\displaystyle y}     =                                    y                        0                                     {\displaystyle y_{0}}     + t                                   m                        3                                     {\displaystyle m_{3}}    ,  and                         z                 {\displaystyle z}     =                                    z                        0                                     {\displaystyle z_{0}}     + t                                   n                        3                                     {\displaystyle n_{3}}    , where                                    x                        0                                     {\displaystyle x_{0}}    =                                    C                        1                                        l                        1                                     {\displaystyle C_{1}l_{1}}     +                                    C                        2                                        l                        2                                     {\displaystyle C_{2}l_{2}}    ,                                    y                        0                                     {\displaystyle y_{0}}     =                                    C                        1                                        m                        1                                     {\displaystyle C_{1}m_{1}}     +                                    C                        2                                        m                        2                                     {\displaystyle C_{2}m_{2}}    , and                                    z                        0                                     {\displaystyle z_{0}}     =                                    C                        1                                        n                        1                                     {\displaystyle C_{1}n_{1}}     +                                   C                        2                                        n                        2                                     {\displaystyle C_{2}n_{2}}    . and                                                                                 N                                    i                                               ^                                                  {\displaystyle {\hat {N_{i}}}}    =(                                   l                        i                                     {\displaystyle l_{i}}    ,                                   m                        i                                     {\displaystyle m_{i}}    ,                                   n                        i                                     {\displaystyle n_{i}}    ), for i=1,2,3. To find the intersection of this line with the earth, plug the line equations into                                                                x                                2                                                        a                                2                                                         +                                                y                                2                                                        a                                2                                                         +                                                z                                2                                                        b                                2                                                         =         1                 {\displaystyle {\frac {x^{2}}{a^{2}}}+{\frac {y^{2}}{a^{2}}}+{\frac {z^{2}}{b^{2}}}=1}    , to get                         A                    t                        2                             +         2         B         t         +         C         =         0                 {\displaystyle At^{2}+2Bt+C=0}    , where                         A                 {\displaystyle A}     =                                    l                        3                                   2                             +                    m                        3                                   2                             +                                                a                                2                                                        b                                2                                                                    n                        3                                   2                                     {\displaystyle l_{3}^{2}+m_{3}^{2}+{\frac {a^{2}}{b^{2}}}n_{3}^{2}}    ,                          B                 {\displaystyle B}     =                                    x                        0                                        l                        3                             +                    y                        0                                        m                        3                             +                                                a                                2                                                        b                                2                                                                    z                        0                                        n                        3                                     {\displaystyle x_{0}l_{3}+y_{0}m_{3}+{\frac {a^{2}}{b^{2}}}z_{0}n_{3}}    ,                         C                 {\displaystyle C}     =                                    x                        0                                   2                             +                    y                        0                                   2                             +                                                a                                2                                                        b                                2                                                                    z                        0                                   2                             −                    a                        2                                     {\displaystyle x_{0}^{2}+y_{0}^{2}+{\frac {a^{2}}{b^{2}}}z_{0}^{2}-a^{2}}    . Therefore, the line intersects the earth at                         t         =                                                −               B               ±                                                                                               B                                                                 2                                                           −                   A                   C                                                          A                                     {\displaystyle t={\frac {-B\pm {\sqrt {{B}^{2}-AC}}}{A}}}    . If                                    B                        2                             <         A         C                 {\displaystyle B^{2}<AC}    , then there is no intersection. If                                    B                        2                             =         A         C                 {\displaystyle B^{2}=AC}    , then the line is tangent to the earth at                         t         =         −         B                    /                  A                 {\displaystyle t=-B/A}     (i.e. the sections intersect at that single point). Observe that                         A         ≠         0                 {\displaystyle A\neq 0}     since                                                                                 N                                    1                                               ^                                                  {\displaystyle {\hat {N_{1}}}}     and                                                                                 N                                    2                                               ^                                                  {\displaystyle {\hat {N_{2}}}}    are not colinear.  Plugging t into                         R                 {\displaystyle R}     =                                    R                        0                                     {\displaystyle R_{0}}     + t                                                                                N                                    3                                               ^                                                  {\displaystyle {\hat {N_{3}}}}    , gives the points of intersection of the earth sections. on a earth section path may be found by dropping the subscripts on the given section;                                                                                 N                                    1                                               ^                                          =         (         l         ,         m         ,         n         )                 {\displaystyle {\hat {N_{1}}}=(l,m,n)}    ,                                     d                        1                             =         d                 {\displaystyle d_{1}=d}    , and setting                                                                                 N                                    2                                               ^                                          =         (         0         ,         0         ,         1         )                 {\displaystyle {\hat {N_{2}}}=(0,0,1)}    , so that                                                                                 N                                    3                                               ^                                          =         (         m         ,         −         l         ,         0         )                 {\displaystyle {\hat {N_{3}}}=(m,-l,0)}    . Then solve for                                    d                        2                             =                    z                        2                                     {\displaystyle d_{2}=z_{2}}     such that                                    B                        2                             =         A         C                 {\displaystyle B^{2}=AC}    . Since                         B         =         0                 {\displaystyle B=0}    , and                         A         ≠         0                 {\displaystyle A\neq 0}    , we must have                         C         =         0                 {\displaystyle C=0}    . Plugging t into                         R                 {\displaystyle R}     =                                    R                        0                             +         t                                                                 N                                    3                                               ^                                                  {\displaystyle R_{0}+t{\hat {N_{3}}}}    , gives the points of intersection of the earth sections. Alternatively, just set                         R         =                                 R                            c                                          ±                    b                        ∗                                                                                     j                                    ∗                                               ^                                                  {\displaystyle R={R_{c}}\pm b^{*}\mathbf {\hat {j^{*}}} }    . on a earth section path may be found by dropping the subscripts on the given section;                                                                                 N                                    1                                               ^                                          =         (         l         ,         m         ,         n         )                 {\displaystyle {\hat {N_{1}}}=(l,m,n)}    ,                                     d                        1                             =         d                 {\displaystyle d_{1}=d}    , and setting                                                                                 N                                    2                                               ^                                          =         (         −         sin         ⁡         θ         ,         cos         ⁡         θ         ,         0         )                 {\displaystyle {\hat {N_{2}}}=(-\sin \theta ,\cos \theta ,0)}    , where                         θ                 {\displaystyle \theta }     is the longitude to be solved for such that                                    B                        2                             =         A         C                 {\displaystyle B^{2}=AC}    . Alternatively, just set                         R         =                                 R                            c                                          ±                    a                        ∗                                                                                     i                                    ∗                                               ^                                                  {\displaystyle R={R_{c}}\pm a^{*}\mathbf {\hat {i^{*}}} }    . 