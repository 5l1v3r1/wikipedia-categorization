In spatial statistics the theoretical variogram                         2         γ         (                                 s                                   1                             ,                                 s                                   2                             )                 {\displaystyle 2\gamma (\mathbf {s} _{1},\mathbf {s} _{2})}     is a function describing the degree of spatial dependence of a spatial random field or stochastic process                         Z         (                    s                  )                 {\displaystyle Z(\mathbf {s} )}    .  In the case of a concrete example from the field of gold mining, a variogram will give a measure of how much two samples taken from the mining area will vary in gold percentage depending on the distance between those samples. Samples taken far apart will vary more than samples taken close to each other. The semivariogram                         γ         (         h         )                 {\displaystyle \gamma (h)}     was first defined by Matheron (1963) as half the average squared difference between points (                                                s                                   1                                     {\displaystyle \mathbf {s} _{1}}     and                                                 s                                   2                                     {\displaystyle \mathbf {s} _{2}}    ) separated at distance                         h                 {\displaystyle h}    .   Formally where                         M                 {\displaystyle M}     is a point in the geometric field                         V                 {\displaystyle V}    , and                         f         (         M         )                 {\displaystyle f(M)}     is the value at that point. For example, suppose we are interested in iron content in soil samples in some region or field                         V                 {\displaystyle V}    .                         f         (         M         )                 {\displaystyle f(M)}     would be the content (e.g., in mg iron per kg soil) of iron at some location                         M                 {\displaystyle M}    , where                         M                 {\displaystyle M}     has coordinates of latitude, longitude, and depth. The triple integral is over 3 dimensions.                         h                 {\displaystyle h}     is the separation distance (e.g., in m or km) of interest. To obtain the semivariogram for a given                         γ         (         h         )                 {\displaystyle \gamma (h)}    , all pairs of points at that exact distance would be sampled. In practice it is impossible to sample everywhere, so the empirical variogram is used instead. The variogram is defined as the variance of the difference between field values at two locations (                                                s                                   1                                     {\displaystyle \mathbf {s} _{1}}     and                                                 s                                   2                                     {\displaystyle \mathbf {s} _{2}}    , note change of notation from                         M                 {\displaystyle M}     to                                    s                          {\displaystyle \mathbf {s} }     and                         f                 {\displaystyle f}     to                         Z                 {\displaystyle Z}    ) across realizations of the field (Cressie 1993): or in other words is twice the semivariogram. If the spatial random field has constant mean                         μ                 {\displaystyle \mu }    , this is equivalent to the expectation for the squared increment of the values between locations                                                 s                                   1                                     {\displaystyle \mathbf {s} _{1}}     and                                    s                        2                                     {\displaystyle s_{2}}     (Wackernagel 2003) (where                                                 s                                   1                                     {\displaystyle \mathbf {s} _{1}}     and                                                 s                                   2                                     {\displaystyle \mathbf {s} _{2}}     are points in space and possibly time): In the case of a stationary process, the variogram and semivariogram can be represented as a function                                    γ                        s                             (         h         )         =         γ         (         0         ,         0         +         h         )                 {\displaystyle \gamma _{s}(h)=\gamma (0,0+h)}     of the difference                         h         =                                 s                                   2                             −                                 s                                   1                                     {\displaystyle h=\mathbf {s} _{2}-\mathbf {s} _{1}}     between locations only, by the following relation (Cressie 1993): If the process is furthermore isotropic, then the variogram and semivariogram can be represented by a function                                    γ                        i                             (         h         )         :=                    γ                        s                             (         h                    e                        1                             )                 {\displaystyle \gamma _{i}(h):=\gamma _{s}(he_{1})}     of the distance                          h         =         ‖                                 s                                   2                             −                                 s                                   1                             ‖                 {\displaystyle h=\|\mathbf {s} _{2}-\mathbf {s} _{1}\|}     only (Cressie 1993): The indexes                         i                 {\displaystyle i}     or                         s                 {\displaystyle s}     are typically not written. The terms are used for all three forms of the function. Moreover, the term "variogram" is sometimes used to denote the semivariogram, and the symbol                         γ                 {\displaystyle \gamma }     is sometimes used for the variogram, which brings some confusion. According to (Cressie 1993, Chiles and Delfiner 1999, Wackernagel 2003) the theoretical variogram has the following properties:                                    ∑                        i             =             1                                   N                                        ∑                        j             =             1                                   N                                        w                        i                             γ         (                                 s                                   i                             ,                                 s                                   j                             )                    w                        j                             ≤         0                 {\displaystyle \sum _{i=1}^{N}\sum _{j=1}^{N}w_{i}\gamma (\mathbf {s} _{i},\mathbf {s} _{j})w_{j}\leq 0}                            2         γ         (                                 s                                   1                             ,                                 s                                   2                             )         =         C         (                                 s                                   1                             ,                                 s                                   1                             )         +         C         (                                 s                                   2                             ,                                 s                                   2                             )         −         2         C         (                                 s                                   1                             ,                                 s                                   2                             )                 {\displaystyle 2\gamma (\mathbf {s} _{1},\mathbf {s} _{2})=C(\mathbf {s} _{1},\mathbf {s} _{1})+C(\mathbf {s} _{2},\mathbf {s} _{2})-2C(\mathbf {s} _{1},\mathbf {s} _{2})}                            2         γ         (                                 s                                   1                             ,                                 s                                   2                             )         =         C         (                                 s                                   1                             ,                                 s                                   1                             )         +         C         (                                 s                                   2                             ,                                 s                                   2                             )         −         2         C         (                                 s                                   1                             ,                                 s                                   2                             )         +         (         E                    [                        Z             (                                             s                                               1                                         )                      ]                  −         E                    [                        Z             (                                             s                                               2                                         )                      ]                             )                        2                                     {\displaystyle 2\gamma (\mathbf {s} _{1},\mathbf {s} _{2})=C(\mathbf {s} _{1},\mathbf {s} _{1})+C(\mathbf {s} _{2},\mathbf {s} _{2})-2C(\mathbf {s} _{1},\mathbf {s} _{2})+(E\left[Z(\mathbf {s} _{1})\right]-E\left[Z(\mathbf {s} _{2})\right])^{2}}    Generally an empirical variogram is needed, because sample information                         Z                 {\displaystyle Z}     is not available for every location. The sample information could be concentration of iron in soil samples, pixel intensity on a camera or the property of a material.  Each piece of sample information has coordinates                                    s                  =         (         x         ,         y         )                 {\displaystyle \mathbf {s} =(x,y)}     for a 2D sample space where                         x                 {\displaystyle x}     and                         y                 {\displaystyle y}     are geographical coordinates. In the case of the iron in soil, the sample space could be 3 dimensional. If there is temporal variability as well (e.g., phosphorus content in a lake) then                                    s                          {\displaystyle \mathbf {s} }     could be a 4 dimensional vector                         (         x         ,         y         ,         z         ,         t         )                 {\displaystyle (x,y,z,t)}    . For the case where dimensions have different units (e.g., distance and time) then a scaling factor                         B                 {\displaystyle B}     can be applied to each to obtain a modified Euclidean distance.  Sample observations are denoted                         Z         (                                 s                                   i                             )         =                    z                        i                                     {\displaystyle Z(\mathbf {s} _{i})=z_{i}}    . Samples may be taken at                         k                 {\displaystyle k}     total different locations. This would provide as set of samples                                    z                        1                             ,         …         ,                    z                        k                                     {\displaystyle z_{1},\ldots ,z_{k}}     at locations                                                 s                                   1                             ,         …         ,                                 s                                   k                                     {\displaystyle \mathbf {s} _{1},\ldots ,\mathbf {s} _{k}}    . Generally plots show the semivariogram values as a function of sample point separation                         h                 {\displaystyle h}    . In the case of empirical semivariogram, separation distance bins                         h         ±         δ                 {\displaystyle h\pm \delta }     are used rather than exact distances, and usually isotropic conditions are assumed (i.e., that                         γ                 {\displaystyle \gamma }     is only a function of                         h                 {\displaystyle h}     and does not depend on other variables such as center position). Then, the empirical semivariogram                                                                γ               ^                                          (         h         ±         δ         )                 {\displaystyle {\hat {\gamma }}(h\pm \delta )}     can be calculated for each bin:                                                                γ               ^                                          (         h         ±         δ         )         :=                                 1                            2                                |                              N               (               h               ±               δ               )                                |                                                                    ∑                        (             i             ,             j             )             ∈             N             (             h             ±             δ             )                                        |                             z                        i                             −                    z                        j                                                     |                                   2                                     {\displaystyle {\hat {\gamma }}(h\pm \delta ):={\frac {1}{2|N(h\pm \delta )|}}\sum _{(i,j)\in N(h\pm \delta )}|z_{i}-z_{j}|^{2}}     Or in other words, each pair of points separated by                         h                 {\displaystyle h}     (plus or minus some bin width tolerance range                         δ                 {\displaystyle \delta }    ) are found. These form the set of points                         N         (         h         ±         δ         )         ≡         {         (                                 s                                   i                             ,                                 s                                   j                             )         :                    |                                          s                                   i                             ,                                 s                                   j                                        |                  =         h         ±         δ         ;         i         ,         j         =         1         ,         …         ,         N         }                 {\displaystyle N(h\pm \delta )\equiv \{(\mathbf {s} _{i},\mathbf {s} _{j}):|\mathbf {s} _{i},\mathbf {s} _{j}|=h\pm \delta ;i,j=1,\ldots ,N\}}    . The number of these points in this bin is                                    |                  N         (         h         ±         δ         )                    |                          {\displaystyle |N(h\pm \delta )|}    . Then for each pair of points                         i         ,         j                 {\displaystyle i,j}    , the square of the difference in the observation (e.g., soil sample content or pixel intensity) is found (                                   |                             z                        i                             −                    z                        j                                                     |                                   2                                     {\displaystyle |z_{i}-z_{j}|^{2}}    ). These squared differences are added together and normalized by the natural number                                    |                  N         (         h         ±         δ         )                    |                          {\displaystyle |N(h\pm \delta )|}    . By definition the result is divided by 2 for the semivariogram at this separation. For computational speed, only the unique pairs of points are needed. For example, for 2 observations pairs [                        (                    z                        a                             ,                    z                        b                             )         ,         (                    z                        c                             ,                    z                        d                             )                 {\displaystyle (z_{a},z_{b}),(z_{c},z_{d})}    ] taken from locations with separation                         h         ±         δ                 {\displaystyle h\pm \delta }     only [                        (                    z                        a                             ,                    z                        b                             )         ,         (                    z                        c                             ,                    z                        d                             )                 {\displaystyle (z_{a},z_{b}),(z_{c},z_{d})}    ] need to be considered, as the pairs [                        (                    z                        b                             ,                    z                        a                             )         ,         (                    z                        d                             ,                    z                        c                             )                 {\displaystyle (z_{b},z_{a}),(z_{d},z_{c})}    ] do not provide any additional information.  The empirical variogram is used in geostatistics as a first estimate of the (theoretical) variogram needed for spatial interpolation by kriging.  According to (Cressie 1993), for observations                                    z                        i                             =         Z         (                                 s                                   i                             )                 {\displaystyle z_{i}=Z(\mathbf {s} _{i})}     from a stationary random field                         Z         (                    s                  )                 {\displaystyle Z(\mathbf {s} )}    , the empirical variogram with lag tolerance 0 is an unbiased estimator of the theoretical semivariogram, due to:                         E                    [                                                                           γ                   ^                                                          (             h             )                      ]                  =                                 1                            2                                |                              N               (               h               )                                |                                                                    ∑                        (             i             ,             j             )             ∈             N             (             h             )                             E                    [                                       |                          Z             (                            s                                i                                         )             −             Z             (                            s                                j                                         )                                             |                                               2                                                  ]                  =                                 1                            2                                |                              N               (               h               )                                |                                                                    ∑                        (             i             ,             j             )             ∈             N             (             h             )                             2         γ         (                    s                        j                             −                    s                        i                             )         =                                                2                                |                              N               (               h               )                                |                                                        2                                |                              N               (               h               )                                |                                                         γ         (         h         )                 {\displaystyle E\left[{\hat {\gamma }}(h)\right]={\frac {1}{2|N(h)|}}\sum _{(i,j)\in N(h)}E\left[|Z(s_{i})-Z(s_{j})|^{2}\right]={\frac {1}{2|N(h)|}}\sum _{(i,j)\in N(h)}2\gamma (s_{j}-s_{i})={\frac {2|N(h)|}{2|N(h)|}}\gamma (h)}     The following parameters are often used to describe variograms: The empirical variogram cannot be computed at every lag distance                         h                 {\displaystyle h}     and due to variation in the estimation it is not ensured that it is a valid variogram, as defined above. However some Geostatistical methods such as kriging need valid semivariograms. In applied geostatistics the empirical variograms are thus often approximated by model function ensuring validity (Chiles&Delfiner 1999). Some important models are (Chiles&Delfiner 1999, Cressie 1993):  The parameter                         a                 {\displaystyle a}     has different values in different references, due to the ambiguity in the definition of the range. E.g.                         a         =         1                    /                  3                 {\displaystyle a=1/3}     is the value used in (Chiles&Delfiner 1999). The                                    1                        A                             (         h         )                 {\displaystyle 1_{A}(h)}     function is 1 if                         h         ∈         A                 {\displaystyle h\in A}     and 0 otherwise. Three functions are used in geostatistics for describing the spatial or the temporal correlation of observations: these are the correlogram, the covariance and the semivariogram. The last is also more simply called variogram. The sampling variogram, unlike the semivariogram and the variogram, shows where a significant degree of spatial dependence in the sample space or sampling unit dissipates into randomness when the variance terms of a temporally or in-situ ordered set are plotted against the variance of the set and the lower limits of its 99% and 95% confidence ranges. The variogram is the key function in geostatistics as it will be used to fit a model of the temporal/spatial correlation of the observed phenomenon. One is thus making a distinction between the experimental variogram that is a visualisation of a possible spatial/temporal correlation and the variogram model that is further used to define the weights of the kriging function. Note that the experimental variogram is an empirical estimate of the covariance of a Gaussian process. As such, it may not be positive definite and hence not directly usable in kriging, without constraints or further processing. This explains why only a limited number of variogram models are used: most commonly, the linear, the spherical, the Gaussian and the exponential models.  The squared term in the variogram, for instance                         (         Z         (                                 s                                   1                             )         −         Z         (                                 s                                   2                             )                    )                        2                                     {\displaystyle (Z(\mathbf {s} _{1})-Z(\mathbf {s} _{2}))^{2}}    , can be replaced with different powers: A madogram is defined with the absolute difference,                                    |                  Z         (                                 s                                   1                             )         −         Z         (                                 s                                   2                             )                    |                          {\displaystyle |Z(\mathbf {s} _{1})-Z(\mathbf {s} _{2})|}    , and a rodogram is defined with the square root of the absolute difference,                                    |                  Z         (                                 s                                   1                             )         −         Z         (                                 s                                   2                             )                                 |                                   0.5                                     {\displaystyle |Z(\mathbf {s} _{1})-Z(\mathbf {s} _{2})|^{0.5}}    . Estimators based on these lower powers are said to be more resistant to outliers. They can be generalized as a "variogram of order α", in which a variogram is of order 2, a madogram is a variogram of order 1, and a rodogram is a variogram of order 0.5.  When a variogram is used to describe the correlation of different variables it is called cross-variogram. Cross-variograms are used in co-kriging. Should the variable be binary or represent classes of values, one is then talking about indicator variograms. Indicator variogram is used in indicator kriging. 